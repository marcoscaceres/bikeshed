<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Web Workers</title>
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet" type="text/css">
  <link href="https://w3c.github.io/workers/" rel="canonical">
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-dfn-panel */

.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: #DDDDDD;
    color: black;
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: black; }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Web Workers</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/workers/">https://w3c.github.io/workers/</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="http://sangwhan.com">Sangwhan Moon</a> (<span class="p-org org">Invited Expert</span>)
     <dt class="editor">Former Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:ian@hixie.ch">Ian Hickson</a> (<a class="p-org org" href="https://google.com">Google</a>)
     <dt>Participate:
     <dd><a href="https://github.com/w3c/workers/issues/new">File an Issue</a>
     <dd>(<a href="https://github.com/w3c/workers/issues">Open Issues</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines an API that allows Web application authors

          to spawn background workers running scripts in parallel to their main
          page. This allows for thread-like operation with message-passing as
          the coordination mechanism.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="https://www.w3.org/WebPlatform/WG/">Web Platform Working Group</a> as an Editors Draft. This document is intended to become a W3C Recommendation. </p>
   <p></p>
   <p> Feedback and comments on this specification are welcome, please send them to <a href="mailto:public-webapps@w3.org?subject=%5Bworkers%5D">public-webapps@w3.org</a> (<a href="mailto:public-webapps@w3.org?subject=subscribe">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/public-webapps/">archives</a>) with <code>[workers]</code> at the start of your email’s subject. </p>
   <p> Publication as an Editors Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/2004/01/pp-impl/83482/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p>This document is governed by the <a href="https://www.w3.org/2019/Process-20190301/" id="w3c_process_revision">1 March 2019 W3C Process Document</a>. </p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#scope"><span class="secno">1.1</span> <span class="content">Scope</span></a>
      <li>
       <a href="#examples"><span class="secno">1.2</span> <span class="content">Examples</span></a>
       <ol class="toc">
        <li><a href="#examples-1"><span class="secno">1.2.1</span> <span class="content">A background number-crunching worker</span></a>
        <li><a href="#examples-2"><span class="secno">1.2.2</span> <span class="content"><code class="idl"><span>Worker</span></code> used for background I/O</span></a>
        <li><a href="#examples-3"><span class="secno">1.2.3</span> <span class="content">Shared workers introduction</span></a>
        <li><a href="#examples-4"><span class="secno">1.2.4</span> <span class="content">Shared state using a shared worker</span></a>
        <li><a href="#examples-5"><span class="secno">1.2.5</span> <span class="content">Delegation</span></a>
       </ol>
      <li>
       <a href="#tutorials"><span class="secno">1.3</span> <span class="content">Tutorials</span></a>
       <ol class="toc">
        <li><a href="#tutorial-1"><span class="secno">1.3.1</span> <span class="content">Creating a dedicated worker</span></a>
        <li><a href="#tutorial-2"><span class="secno">1.3.2</span> <span class="content">Communicating with a dedicated worker</span></a>
        <li><a href="#tutorial-3"><span class="secno">1.3.3</span> <span class="content">Shared workers</span></a>
       </ol>
     </ol>
    <li><a href="#terminology"><span class="secno">2</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#infrastructure"><span class="secno">3</span> <span class="content">Infrastructure</span></a>
     <ol class="toc">
      <li>
       <a href="#global-scope"><span class="secno">3.1</span> <span class="content">The global scope</span></a>
       <ol class="toc">
        <li><a href="#workerglobalscope"><span class="secno">3.1.1</span> <span class="content">The <code class="idl"><span>WorkerGlobalScope</span></code> common interface</span></a>
        <li><a href="#dedicated-workers"><span class="secno">3.1.2</span> <span class="content">Dedicated workers and the <code class="idl"><span>DedicatedWorkerGlobalScope</span></code> interface</span></a>
        <li><a href="#shared-workers"><span class="secno">3.1.3</span> <span class="content">Shared workers and the <code class="idl"><span>SharedWorkerGlobalScope</span></code> interface</span></a>
       </ol>
      <li><a href="#event-loop"><span class="secno">3.2</span> <span class="content">The event loop</span></a>
      <li><a href="#worker-lifetime"><span class="secno">3.3</span> <span class="content">The worker’s lifetime</span></a>
      <li><a href="#processing-model"><span class="secno">3.4</span> <span class="content">Processing model</span></a>
      <li><a href="#runtime-script-errors"><span class="secno">3.5</span> <span class="content">Runtime script errors</span></a>
      <li>
       <a href="#creating-workers"><span class="secno">3.6</span> <span class="content">Creating workers</span></a>
       <ol class="toc">
        <li><a href="#abstract-worker-interface"><span class="secno">3.6.1</span> <span class="content">The <code class="idl"><span>AbstractWorker</span></code> abstract interface</span></a>
        <li><a href="#script-settings"><span class="secno">3.6.2</span> <span class="content">Script settings for workers</span></a>
        <li><a href="#dedicated-workers-and-worker-interface"><span class="secno">3.6.3</span> <span class="content">Dedicated workers and the <code class="idl"><span>Worker</span></code> interface</span></a>
        <li><a href="#shared-workers-and-sharedworker-interface"><span class="secno">3.6.4</span> <span class="content">Shared workers and the <code class="idl"><span>SharedWorker</span></code> interface</span></a>
       </ol>
      <li><a href="#concurrency"><span class="secno">3.7</span> <span class="content">Concurrent hardware capabilities</span></a>
      <li><a href="#importing"><span class="secno">3.8</span> <span class="content">Importing scripts and libraries</span></a>
      <li><a href="#workernavigator-object"><span class="secno">3.9</span> <span class="content">The WorkerNavigator object</span></a>
      <li><a href="#worker-locations"><span class="secno">3.10</span> <span class="content"><code class="idl"><span>WorkerLocation</span></code> interface</span></a>
      <li><a href="#security-considerations"><span class="secno">3.11</span> <span class="content">Security Considerations</span></a>
      <li><a href="#privacy-considerations"><span class="secno">3.12</span> <span class="content">Privacy Considerations</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno"></span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="scope"><span class="secno">1.1. </span><span class="content">Scope</span><a class="self-link" href="#scope"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>This specification defines an API for running scripts in the background
independently of any user interface scripts.</p>
   <p>This allows for long-running scripts that are not interrupted by scripts that
respond to clicks or other user interactions, and allows long tasks to be
executed without yielding to keep the page responsive.</p>
   <p><code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker">Worker</a></code>s (as these background scripts are called herein) are relatively
heavy-weight, and are not intended to be used in large numbers. For example,
it would be inappropriate to launch one worker for each pixel of a four
megapixel image. The examples below show some appropriate uses of workers.</p>
   <p>Generally, workers are expected to be long-lived, have a high start-up
performance cost, and a high per-instance memory cost.</p>
   <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>There are a variety of uses that workers can be put to. The following
subsections show various examples of this use.</p>
   <h4 class="heading settled" data-level="1.2.1" id="examples-1"><span class="secno">1.2.1. </span><span class="content">A background number-crunching worker</span><a class="self-link" href="#examples-1"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>The simplest use of workers is for performing a computationally expensive task
without interrupting the user interface.</p>
   <p>In this example, the main document spawns a worker to (naïvely) compute prime
numbers, and progressively displays the most recently found prime number.</p>
   <p>The main page is as follows:</p>
<pre class="example lang-html highlight" id="example-72fa6673"><a class="self-link" href="#example-72fa6673"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>html</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>head</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>title</c-><c- p>></c->Worker example: One-core computation<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>head</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->The highest prime number discovered so far is: <c- p>&lt;</c-><c- f>output</c-> <c- e>id</c-><c- o>=</c-><c- s>"result"</c-><c- p>>&lt;/</c-><c- f>output</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'worker.js'</c-><c- p>);</c->
   worker<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     document<c- p>.</c->getElementById<c- p>(</c-><c- t>'result'</c-><c- p>).</c->textContent <c- o>=</c-> event<c- p>.</c->data<c- p>;</c->
   <c- p>};</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
   <p>The <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①">Worker</a></code>() constructor call creates a worker and returns a <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker②">Worker</a></code> object representing that worker, which is used to communicate with the worker.
That object’s <code class="idl"><a data-link-type="idl" href="#handler-dedicatedworkerglobalscope-onmessage" id="ref-for-handler-dedicatedworkerglobalscope-onmessage">onmessage</a></code> event handler allows the code to receive messages from
the worker.</p>
   <p>The worker itself is as follows:</p>
<pre class="example lang-js highlight" id="example-3bac21f3"><a class="self-link" href="#example-3bac21f3"></a><c- a>var</c-> n <c- o>=</c-> <c- mi>1</c-><c- p>;</c->
search<c- o>:</c-> <c- k>while</c-> <c- p>(</c-><c- kc>true</c-><c- p>)</c-> <c- p>{</c->
  n <c- o>+=</c-> <c- mi>1</c-><c- p>;</c->
  <c- k>for</c-> <c- p>(</c-><c- a>var</c-> i <c- o>=</c-> <c- mi>2</c-><c- p>;</c-> i <c- o>&lt;=</c-> Math<c- p>.</c->sqrt<c- p>(</c->n<c- p>);</c-> i <c- o>+=</c-> <c- mi>1</c-><c- p>)</c->
    <c- k>if</c-> <c- p>(</c->n <c- o>%</c-> i <c- o>==</c-> <c- mi>0</c-><c- p>)</c->
     <c- k>continue</c-> search<c- p>;</c->
  <c- c1>// Found a prime!</c->
  postMessage<c- p>(</c->n<c- p>);</c->
<c- p>}</c->
</pre>
   <p>The bulk of this code is simply an unoptimised search for a prime number.
The <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-postmessage" id="ref-for-dom-dedicatedworkerglobalscope-postmessage">postMessage()</a></code> method is used to send a message back to the page when a
prime is found.</p>
   <p><a href="https://whatwg.org/demos/workers/primes/page.html"> View this example online. </a></p>
   <h4 class="heading settled" data-level="1.2.2" id="examples-2"><span class="secno">1.2.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker③">Worker</a></code> used for background I/O</span><a class="self-link" href="#examples-2"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>In this example, the main document uses two workers, one for fetching stock
updates at regular intervals, and one for performing search queries that the
user requests.</p>
   <p>The main page is as follows:</p>
<pre class="lang-html highlight"><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>html</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>head</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>title</c-><c- p>></c->Worker example: Stock ticker<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   <c- c1>// Ticker</c->
   <c- a>var</c-> symbol <c- o>=</c-> <c- t>'GOOG'</c-><c- p>;</c-> <c- c1>// default symbol to watch</c->
   <c- a>var</c-> ticker <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'ticker.js'</c-><c- p>);</c->

   <c- c1>// Searcher</c->
   <c- a>var</c-> searcher <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'searcher.js'</c-><c- p>);</c->
   <c- a>function</c-> search<c- p>(</c->query<c- p>)</c-> <c- p>{</c->
     searcher<c- p>.</c->postMessage<c- p>(</c->query<c- p>);</c->
   <c- p>}</c->

   <c- c1>// Symbol selection UI</c->
   <c- a>function</c-> select<c- p>(</c->newSymbol<c- p>)</c-> <c- p>{</c->
     symbol <c- o>=</c-> newSymbol<c- p>;</c->
     ticker<c- p>.</c->postMessage<c- p>(</c->symbol<c- p>);</c->
   <c- p>}</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>head</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>body</c-> <c- e>onload</c-><c- o>=</c-><c- s>"search('')"</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>output</c-> <c- e>id</c-><c- o>=</c-><c- s>"symbol"</c-><c- p>>&lt;/</c-><c- f>output</c-><c- p>></c-> <c- p>&lt;</c-><c- f>output</c-> <c- e>id</c-><c- o>=</c-><c- s>"value"</c-><c- p>>&lt;/</c-><c- f>output</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   ticker<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     <c- a>var</c-> data <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->split<c- p>(</c-><c- t>' '</c-><c- p>);</c->
     document<c- p>.</c->getElementById<c- p>(</c-><c- t>'symbol'</c-><c- p>).</c->textContent <c- o>=</c-> data<c- p>[</c-><c- mi>0</c-><c- p>];</c->
     document<c- p>.</c->getElementById<c- p>(</c-><c- t>'value'</c-><c- p>).</c->textContent <c- o>=</c-> data<c- p>[</c-><c- mi>1</c-><c- p>];</c->
   <c- p>};</c->
   ticker<c- p>.</c->postMessage<c- p>(</c->symbol<c- p>);</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>label</c-><c- p>></c->Search: <c- p>&lt;</c-><c- f>input</c-> <c- e>type</c-><c- o>=</c-><c- s>"text"</c-> <c- e>autofocus</c-> <c- e>oninput</c-><c- o>=</c-><c- s>"search(this.value)"</c-><c- p>>&lt;/</c-><c- f>label</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>ul</c-> <c- e>id</c-><c- o>=</c-><c- s>"results"</c-><c- p>>&lt;/</c-><c- f>ul</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   searcher<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     <c- a>var</c-> data <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->split<c- p>(</c-><c- t>' '</c-><c- p>);</c->
     <c- a>var</c-> results <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'results'</c-><c- p>);</c->
     <c- k>while</c-> <c- p>(</c->results<c- p>.</c->hasChildNodes<c- p>())</c-> <c- c1>// Clear previous results</c->
       results<c- p>.</c->removeChild<c- p>(</c->results<c- p>.</c->firstChild<c- p>);</c->
     <c- k>for</c-> <c- p>(</c-><c- a>var</c-> i <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> i <c- o>&lt;</c-> data<c- p>.</c->length<c- p>;</c-> i <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
       <c- c1>// Add a list item with a button for each result</c->
       <c- a>var</c-> li <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'li'</c-><c- p>);</c->
       <c- a>var</c-> button <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'button'</c-><c- p>);</c->
       button<c- p>.</c->value <c- o>=</c-> data<c- p>[</c->i<c- p>];</c->
       button<c- p>.</c->type <c- o>=</c-> <c- t>'button'</c-><c- p>;</c->
       button<c- p>.</c->onclick <c- o>=</c-> <c- a>function</c-> <c- p>()</c-> <c- p>{</c-> select<c- p>(</c-><c- k>this</c-><c- p>.</c->value<c- p>);</c-> <c- p>};</c->
       button<c- p>.</c->textContent <c- o>=</c-> data<c- p>[</c->i<c- p>];</c->
       li<c- p>.</c->appendChild<c- p>(</c->button<c- p>);</c->
       results<c- p>.</c->appendChild<c- p>(</c->li<c- p>);</c->
     <c- p>}</c->
   <c- p>};</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->(The data in this example is not real. Try searching for "Google" or "Apple".)<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
   <p>The two workers use a common library for performing the actual network calls.
This library is as follows:</p>
<pre class="example lang-js highlight" id="example-0d3b625c"><a class="self-link" href="#example-0d3b625c"></a><c- a>function</c-> get<c- p>(</c->url<c- p>)</c-> <c- p>{</c->
  <c- k>try</c-> <c- p>{</c->
    <c- a>var</c-> xhr <c- o>=</c-> <c- k>new</c-> XMLHttpRequest<c- p>();</c->
    xhr<c- p>.</c->open<c- p>(</c-><c- t>'GET'</c-><c- p>,</c-> url<c- p>,</c-> <c- kc>false</c-><c- p>);</c->
    xhr<c- p>.</c->send<c- p>();</c->
    <c- k>return</c-> xhr<c- p>.</c->responseText<c- p>;</c->
  <c- p>}</c-> <c- k>catch</c-> <c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    <c- k>return</c-> <c- t>''</c-><c- p>;</c-> <c- c1>// Turn all errors into empty results</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <p>The stock updater worker is as follows:</p>
<pre class="example lang-js highlight" id="example-66ef47ea"><a class="self-link" href="#example-66ef47ea"></a>importScripts<c- p>(</c-><c- t>'io.js'</c-><c- p>);</c->
<c- a>var</c-> timer<c- p>;</c->
<c- a>var</c-> symbol<c- p>;</c->
<c- a>function</c-> update<c- p>()</c-> <c- p>{</c->
  postMessage<c- p>(</c->symbol <c- o>+</c-> <c- t>' '</c-> <c- o>+</c-> get<c- p>(</c-><c- t>'stock.cgi?'</c-> <c- o>+</c-> symbol<c- p>));</c->
  timer <c- o>=</c-> setTimeout<c- p>(</c->update<c- p>,</c-> <c- mi>10000</c-><c- p>);</c->
<c- p>}</c->
onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c->timer<c- p>)</c->
    clearTimeout<c- p>(</c->timer<c- p>);</c->
  symbol <c- o>=</c-> event<c- p>.</c->data<c- p>;</c->
  update<c- p>();</c->
<c- p>};</c->
</pre>
   <p>The search query worker is as follows:</p>
<pre class="example lang-js highlight" id="example-ac0353e2"><a class="self-link" href="#example-ac0353e2"></a>importScripts<c- p>(</c-><c- t>'io.js'</c-><c- p>);</c->
onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  postMessage<c- p>(</c->get<c- p>(</c-><c- t>'search.cgi?'</c-> <c- o>+</c-> event<c- p>.</c->data<c- p>));</c->
<c- p>};</c->
</pre>
   <p><a href="https://www.whatwg.org/demos/workers/stocks/page.html"> View this example online. </a></p>
   <h4 class="heading settled" data-level="1.2.3" id="examples-3"><span class="secno">1.2.3. </span><span class="content">Shared workers introduction</span><a class="self-link" href="#examples-3"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>This section introduces shared workers using a Hello World example. Shared
workers use slightly different APIs, since each worker can have multiple
connections.</p>
   <p>This first example shows how you connect to a worker and how a worker can send
a message back to the page when it connects to it. Received messages are
displayed in a log.</p>
   <p>Here is the HTML page:</p>
<pre class="example lang-html highlight" id="example-6cf84186"><a class="self-link" href="#example-6cf84186"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>title</c-><c- p>></c->Shared workers: demo 1<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
<c- p>&lt;</c-><c- f>pre</c-> <c- e>id</c-><c- o>=</c-><c- s>"log"</c-><c- p>></c->Log:<c- p>&lt;/</c-><c- f>pre</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> SharedWorker<c- p>(</c-><c- t>'test.js'</c-><c- p>);</c->
  <c- a>var</c-> log <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'log'</c-><c- p>);</c->
  worker<c- p>.</c->port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c-> <c- c1>// Note: Not worker.onmessage!</c->
    log<c- p>.</c->textContent <c- o>+=</c-> <c- t>'\n'</c-> <c- o>+</c-> e<c- p>.</c->data<c- p>;</c->
  <c- p>}</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
   <p>Here is the JavaScript worker:</p>
<pre class="example lang-js highlight" id="example-c37a5dbe"><a class="self-link" href="#example-c37a5dbe"></a>onconnect <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> port <c- o>=</c-> e<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>];</c->
  port<c- p>.</c->postMessage<c- p>(</c-><c- t>'Hello World!'</c-><c- p>);</c->
<c- p>}</c->
</pre>
   <p><a href="https://www.whatwg.org/demos/workers/shared/001/test.html"> View this example online. </a></p>
   <p>This second example extends the first one by changing two things: first,
messages are received using <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener" id="ref-for-dom-eventtarget-addeventlistener">addEventListener()</a></code> instead of an event handler
IDL attribute, and second, a message is sent to the worker, causing the
worker to send another message in return. Received messages are again
displayed in a log.</p>
   <p>Here is the HTML page:</p>
<pre class="example lang-html highlight" id="example-48ba756a"><a class="self-link" href="#example-48ba756a"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>title</c-><c- p>></c->Shared workers: demo 2<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
<c- p>&lt;</c-><c- f>pre</c-> <c- e>id</c-><c- o>=</c-><c- s>"log"</c-><c- p>></c->Log:<c- p>&lt;/</c-><c- f>pre</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> SharedWorker<c- p>(</c-><c- t>'test.js'</c-><c- p>);</c->
  <c- a>var</c-> log <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'log'</c-><c- p>);</c->
  worker<c- p>.</c->port<c- p>.</c->addEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    log<c- p>.</c->textContent <c- o>+=</c-> <c- t>'\n'</c-> <c- o>+</c-> e<c- p>.</c->data<c- p>;</c->
  <c- p>},</c-> <c- kc>false</c-><c- p>);</c->
  worker<c- p>.</c->port<c- p>.</c->start<c- p>();</c-> <c- c1>// Note: Needed when using addEventListener</c->
  worker<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'ping'</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
   <p>Here is the JavaScript worker:</p>
<pre class="example lang-js highlight" id="example-03c5c672"><a class="self-link" href="#example-03c5c672"></a>onconnect <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> port <c- o>=</c-> e<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>];</c->
  port<c- p>.</c->postMessage<c- p>(</c-><c- t>'Hello World!'</c-><c- p>);</c->
  port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    port<c- p>.</c->postMessage<c- p>(</c-><c- t>'pong'</c-><c- p>);</c-> <c- c1>// Not e.ports[0].postMessage!</c->
    <c- c1>// e.target.postMessage('pong'); // Also works</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <p><a href="https://www.whatwg.org/demos/workers/shared/002/test.html"> View this example online. </a></p>
   <p>Finally, the example is extended to show how two pages can connect to the same
worker; in this case, the second page is merely in an iframe on the first page,
but the same principle would apply to an entirely separate page in a separate
top-level browsing context.</p>
   <p>Here is the outer HTML page:</p>
<pre class="example lang-html highlight" id="example-647c98ae"><a class="self-link" href="#example-647c98ae"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>title</c-><c- p>></c->Shared workers: demo 3<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
<c- p>&lt;</c-><c- f>pre</c-> <c- e>id</c-><c- o>=</c-><c- s>"log"</c-><c- p>></c->Log:<c- p>&lt;/</c-><c- f>pre</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> SharedWorker<c- p>(</c-><c- t>'test.js'</c-><c- p>);</c->
  <c- a>var</c-> log <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'log'</c-><c- p>);</c->
  worker<c- p>.</c->port<c- p>.</c->addEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    log<c- p>.</c->textContent <c- o>+=</c-> <c- t>'\n'</c-> <c- o>+</c-> e<c- p>.</c->data<c- p>;</c->
  <c- p>},</c-> <c- kc>false</c-><c- p>);</c->
  worker<c- p>.</c->port<c- p>.</c->start<c- p>();</c->
  worker<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'ping'</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"inner.html"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
</pre>
   <p>Here is the inner HTML page:</p>
<pre class="example lang-html highlight" id="example-68ae6e16"><a class="self-link" href="#example-68ae6e16"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>title</c-><c- p>></c->Shared workers: demo 3 inner frame<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
<c- p>&lt;</c-><c- f>pre</c-> <c- e>id</c-><c- o>=</c-><c- s>log</c-><c- p>></c->Inner log:<c- p>&lt;/</c-><c- f>pre</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> SharedWorker<c- p>(</c-><c- t>'test.js'</c-><c- p>);</c->
  <c- a>var</c-> log <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'log'</c-><c- p>);</c->
  worker<c- p>.</c->port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
   log<c- p>.</c->textContent <c- o>+=</c-> <c- t>'\n'</c-> <c- o>+</c-> e<c- p>.</c->data<c- p>;</c->
  <c- p>}</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
   <p>Here is the JavaScript worker:</p>
<pre class="example lang-js highlight" id="example-cb4f9cdf"><a class="self-link" href="#example-cb4f9cdf"></a><c- a>var</c-> count <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
onconnect <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
  count <c- o>+=</c-> <c- mi>1</c-><c- p>;</c->
  <c- a>var</c-> port <c- o>=</c-> e<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>];</c->
  port<c- p>.</c->postMessage<c- p>(</c-><c- t>'Hello World! You are connection #'</c-> <c- o>+</c-> count<c- p>);</c->
  port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-><c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    port<c- p>.</c->postMessage<c- p>(</c-><c- t>'pong'</c-><c- p>);</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <p><a href="https://www.whatwg.org/demos/workers/shared/003/test.html"> View this example online. </a></p>
   <h4 class="heading settled" data-level="1.2.4" id="examples-4"><span class="secno">1.2.4. </span><span class="content">Shared state using a shared worker</span><a class="self-link" href="#examples-4"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>In this example, multiple windows (viewers) can be opened that are all
viewing the same map. All the windows share the same map information, with a
single worker coordinating all the viewers. Each viewer can move around
independently, but if they set any data on the map, all the viewers are
updated.</p>
   <p>The main page isn’t interesting, it merely provides a way to open the viewers:</p>
<pre class="example lang-html highlight" id="example-52af2461"><a class="self-link" href="#example-52af2461"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>html</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>head</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>title</c-><c- p>></c->Workers example: Multiviewer<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   <c- a>function</c-> openViewer<c- p>()</c-> <c- p>{</c->
     window<c- p>.</c->open<c- p>(</c-><c- t>'viewer.html'</c-><c- p>);</c->
   <c- p>}</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>head</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"openViewer()"</c-><c- p>></c->Open a new
  viewer<c- p>&lt;/</c-><c- f>button</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->Each viewer opens in a new window. You can have as many viewers
  as you like, they all view the same data.<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
   <p>The viewer is more involved:</p>
<pre class="example lang-html highlight" id="example-ba9eb8e3"><a class="self-link" href="#example-ba9eb8e3"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>html</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>head</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>title</c-><c- p>></c->Workers example: Multiviewer viewer<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> SharedWorker<c- p>(</c-><c- t>'worker.js'</c-><c- p>,</c-> <c- t>'core'</c-><c- p>);</c->

   <c- c1>// Configuration</c->
   <c- a>function</c-> configure<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c->event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>0</c-><c- p>,</c-> <c- mi>4</c-><c- p>)</c-> <c- o>!=</c-> <c- t>'cfg '</c-><c- p>)</c-> <c- k>return</c-><c- p>;</c->
     <c- a>var</c-> name <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>).</c->split<c- p>(</c-><c- t>' '</c-><c- p>,</c-> <c- mi>1</c-><c- p>)[</c-><c- mi>0</c-><c- p>];</c->
     <c- c1>// update display to mention our name is name</c->
     document<c- p>.</c->getElementsByTagName<c- p>(</c-><c- t>'h1'</c-><c- p>)[</c-><c- mi>0</c-><c- p>].</c->textContent <c- o>+=</c-> <c- t>' '</c-> <c- o>+</c-> name<c- p>;</c->
     <c- c1>// no longer need this listener</c->
     worker<c- p>.</c->port<c- p>.</c->removeEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> configure<c- p>,</c-> <c- kc>false</c-><c- p>);</c->
   <c- p>}</c->
   worker<c- p>.</c->port<c- p>.</c->addEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> configure<c- p>,</c-> <c- kc>false</c-><c- p>);</c->

   <c- c1>// Map</c->
   <c- a>function</c-> paintMap<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c->event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>0</c-><c- p>,</c-> <c- mi>4</c-><c- p>)</c-> <c- o>!=</c-> <c- t>'map '</c-><c- p>)</c-> <c- k>return</c-><c- p>;</c->
     <c- a>var</c-> data <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>).</c->split<c- p>(</c-><c- t>','</c-><c- p>);</c->
     <c- c1>// Display tiles data[0] .. data[8]</c->
     <c- a>var</c-> canvas <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'map'</c-><c- p>);</c->
     <c- a>var</c-> context <c- o>=</c-> canvas<c- p>.</c->getContext<c- p>(</c-><c- t>'2d'</c-><c- p>);</c->
     <c- k>for</c-> <c- p>(</c-><c- a>var</c-> y <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> y <c- o>&lt;</c-> <c- mi>3</c-><c- p>;</c-> y <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
       <c- k>for</c-> <c- p>(</c-><c- a>var</c-> x <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> x <c- o>&lt;</c-> <c- mi>3</c-><c- p>;</c-> x <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
         <c- a>var</c-> tile <c- o>=</c-> data<c- p>[</c->y <c- o>*</c-> <c- mi>3</c-> <c- o>+</c-> x<c- p>];</c->
         <c- k>if</c-> <c- p>(</c->tile <c- o>==</c-> <c- t>'0'</c-><c- p>)</c->
           context<c- p>.</c->fillStyle <c- o>=</c-> <c- t>'green'</c-><c- p>;</c->
         <c- k>else</c->
           context<c- p>.</c->fillStyle <c- o>=</c-> <c- t>'maroon'</c-><c- p>;</c->
         context<c- p>.</c->fillRect<c- p>(</c->x <c- o>*</c-> <c- mi>50</c-><c- p>,</c-> y <c- o>*</c-> <c- mi>50</c-><c- p>,</c-> <c- mi>50</c-><c- p>,</c-> <c- mi>50</c-><c- p>);</c->
       <c- p>}</c->
     <c- p>}</c->
   <c- p>}</c->
   worker<c- p>.</c->port<c- p>.</c->addEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> paintMap<c- p>,</c-> <c- kc>false</c-><c- p>);</c->

   <c- c1>// Public chat</c->
   <c- a>function</c-> updatePublicChat<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c->event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>0</c-><c- p>,</c-> <c- mi>4</c-><c- p>)</c-> <c- o>!=</c-> <c- t>'txt '</c-><c- p>)</c-> <c- k>return</c-><c- p>;</c->
     <c- a>var</c-> name <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>).</c->split<c- p>(</c-><c- t>' '</c-><c- p>,</c-> <c- mi>1</c-><c- p>)[</c-><c- mi>0</c-><c- p>];</c->
     <c- a>var</c-> message <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-> <c- o>+</c-> name<c- p>.</c->length <c- o>+</c-> <c- mi>1</c-><c- p>);</c->
     <c- c1>// display "&lt;name> message" in public chat</c->
     <c- a>var</c-> <c- kr>public</c-> <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'public'</c-><c- p>);</c->
     <c- a>var</c-> p <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'p'</c-><c- p>);</c->
     <c- a>var</c-> n <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'button'</c-><c- p>);</c->
     n<c- p>.</c->textContent <c- o>=</c-> <c- t>'&lt;'</c-> <c- o>+</c-> name <c- o>+</c-> <c- t>'> '</c-><c- p>;</c->
     n<c- p>.</c->onclick <c- o>=</c-> <c- a>function</c-> <c- p>()</c-> <c- p>{</c-> worker<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'msg '</c-> <c- o>+</c-> name<c- p>);</c-> <c- p>};</c->
     p<c- p>.</c->appendChild<c- p>(</c->n<c- p>);</c->
     <c- a>var</c-> m <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'span'</c-><c- p>);</c->
     m<c- p>.</c->textContent <c- o>=</c-> message<c- p>;</c->
     p<c- p>.</c->appendChild<c- p>(</c->m<c- p>);</c->
     <c- kr>public</c-><c- p>.</c->appendChild<c- p>(</c->p<c- p>);</c->
   <c- p>}</c->
   worker<c- p>.</c->port<c- p>.</c->addEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> updatePublicChat<c- p>,</c-> <c- kc>false</c-><c- p>);</c->

   <c- c1>// Private chat</c->
   <c- a>function</c-> startPrivateChat<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     <c- k>if</c-> <c- p>(</c->event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>0</c-><c- p>,</c-> <c- mi>4</c-><c- p>)</c-> <c- o>!=</c-> <c- t>'msg '</c-><c- p>)</c-> <c- k>return</c-><c- p>;</c->
     <c- a>var</c-> name <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>).</c->split<c- p>(</c-><c- t>' '</c-><c- p>,</c-> <c- mi>1</c-><c- p>)[</c-><c- mi>0</c-><c- p>];</c->
     <c- a>var</c-> port <c- o>=</c-> event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>];</c->
     <c- c1>// Display a private chat UI</c->
     <c- a>var</c-> ul <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'private'</c-><c- p>);</c->
     <c- a>var</c-> li <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'li'</c-><c- p>);</c->
     <c- a>var</c-> h3 <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'h3'</c-><c- p>);</c->
     h3<c- p>.</c->textContent <c- o>=</c-> <c- t>'Private chat with '</c-> <c- o>+</c-> name<c- p>;</c->
     li<c- p>.</c->appendChild<c- p>(</c->h3<c- p>);</c->
     <c- a>var</c-> div <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'div'</c-><c- p>);</c->
     <c- a>var</c-> addMessage <c- o>=</c-> <c- a>function</c-><c- p>(</c->name<c- p>,</c-> message<c- p>)</c-> <c- p>{</c->
       <c- a>var</c-> p <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'p'</c-><c- p>);</c->
       <c- a>var</c-> n <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'strong'</c-><c- p>);</c->
       n<c- p>.</c->textContent <c- o>=</c-> <c- t>'&lt;'</c-> <c- o>+</c-> name <c- o>+</c-> <c- t>'> '</c-><c- p>;</c->
       p<c- p>.</c->appendChild<c- p>(</c->n<c- p>);</c->
       <c- a>var</c-> t <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'span'</c-><c- p>);</c->
       t<c- p>.</c->textContent <c- o>=</c-> message<c- p>;</c->
       p<c- p>.</c->appendChild<c- p>(</c->t<c- p>);</c->
       div<c- p>.</c->appendChild<c- p>(</c->p<c- p>);</c->
     <c- p>};</c->
     port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
       addMessage<c- p>(</c->name<c- p>,</c-> event<c- p>.</c->data<c- p>);</c->
     <c- p>};</c->
     li<c- p>.</c->appendChild<c- p>(</c->div<c- p>);</c->
     <c- a>var</c-> form <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'form'</c-><c- p>);</c->
     <c- a>var</c-> p <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'p'</c-><c- p>);</c->
     <c- a>var</c-> input <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'input'</c-><c- p>);</c->
     input<c- p>.</c->size <c- o>=</c-> <c- mi>50</c-><c- p>;</c->
     p<c- p>.</c->appendChild<c- p>(</c->input<c- p>);</c->
     p<c- p>.</c->appendChild<c- p>(</c->document<c- p>.</c->createTextNode<c- p>(</c-><c- t>' '</c-><c- p>));</c->
     <c- a>var</c-> button <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'button'</c-><c- p>);</c->
     button<c- p>.</c->textContent <c- o>=</c-> <c- t>'Post'</c-><c- p>;</c->
     p<c- p>.</c->appendChild<c- p>(</c->button<c- p>);</c->
     form<c- p>.</c->onsubmit <c- o>=</c-> <c- a>function</c-> <c- p>()</c-> <c- p>{</c->
       port<c- p>.</c->postMessage<c- p>(</c->input<c- p>.</c->value<c- p>);</c->
       addMessage<c- p>(</c-><c- t>'me'</c-><c- p>,</c-> input<c- p>.</c->value<c- p>);</c->
       input<c- p>.</c->value <c- o>=</c-> <c- t>''</c-><c- p>;</c->
       <c- k>return</c-> <c- kc>false</c-><c- p>;</c->
     <c- p>};</c->
     form<c- p>.</c->appendChild<c- p>(</c->p<c- p>);</c->
     li<c- p>.</c->appendChild<c- p>(</c->form<c- p>);</c->
     ul<c- p>.</c->appendChild<c- p>(</c->li<c- p>);</c->
   <c- p>}</c->
   worker<c- p>.</c->port<c- p>.</c->addEventListener<c- p>(</c-><c- t>'message'</c-><c- p>,</c-> startPrivateChat<c- p>,</c-> <c- kc>false</c-><c- p>);</c->

   worker<c- p>.</c->port<c- p>.</c->start<c- p>();</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>head</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>h1</c-><c- p>></c->Viewer<c- p>&lt;/</c-><c- f>h1</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>h2</c-><c- p>></c->Map<c- p>&lt;/</c-><c- f>h2</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>canvas</c-> <c- e>id</c-><c- o>=</c-><c- s>"map"</c-> <c- e>height</c-><c- o>=</c-><c- s>150</c-> <c- e>width</c-><c- o>=</c-><c- s>150</c-><c- p>>&lt;/</c-><c- f>canvas</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"worker.port.postMessage('mov left')"</c-><c- p>></c->Left<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"worker.port.postMessage('mov up')"</c-><c- p>></c->Up<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"worker.port.postMessage('mov down')"</c-><c- p>></c->Down<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"worker.port.postMessage('mov right')"</c-><c- p>></c->Right<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"worker.port.postMessage('set 0')"</c-><c- p>></c->Set 0<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>button</c-> <c- e>type</c-><c- o>=</c-><c- s>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"worker.port.postMessage('set 1')"</c-><c- p>></c->Set 1<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>h2</c-><c- p>></c->Public Chat<c- p>&lt;/</c-><c- f>h2</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>id</c-><c- o>=</c-><c- s>"public"</c-><c- p>>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>form</c-> <c- e>onsubmit</c-><c- o>=</c-><c- s>"worker.port.postMessage('txt ' + message.value); message.value = ''; return false;"</c-><c- p>></c->
   <c- p>&lt;</c-><c- f>p</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>input</c-> <c- e>type</c-><c- o>=</c-><c- s>"text"</c-> <c- e>name</c-><c- o>=</c-><c- s>"message"</c-> <c- e>size</c-><c- o>=</c-><c- s>"50"</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>button</c-><c- p>></c->Post<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
   <c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>form</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>h2</c-><c- p>></c->Private Chat<c- p>&lt;/</c-><c- f>h2</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>ul</c-> <c- e>id</c-><c- o>=</c-><c- s>"private"</c-><c- p>>&lt;/</c-><c- f>ul</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
   <p>There are several key things worth noting about the way the viewer is written.</p>
   <p>Multiple listeners. Instead of a single message processing function, the code
here attaches multiple event listeners, each one performing a quick check to
see if it is relevant for the message. In this example it doesn’t make much
difference, but if multiple authors wanted to collaborate using a single port
to communicate with a worker, it would allow for independent code instead of
changes having to all be made to a single event handling function.</p>
   <p>Registering event listeners in this way also allows you to unregister
specific listeners when you are done with them, as is done with the
configure() method in this example. (FIXME: configure() method doesn’t exist...)</p>
   <p>Finally, the worker:</p>
<pre class="example lang-js highlight" id="example-48fce30b"><a class="self-link" href="#example-48fce30b"></a><c- a>var</c-> nextName <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
<c- a>function</c-> getNextName<c- p>()</c-> <c- p>{</c->
  <c- c1>// This could use more friendly names</c->
  <c- c1>// But for now just return a number</c->
  <c- k>return</c-> nextName<c- o>++</c-><c- p>;</c->
<c- p>}</c->

<c- a>var</c-> map <c- o>=</c-> <c- p>[</c->
 <c- p>[</c-><c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>],</c->
 <c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>],</c->
 <c- p>[</c-><c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>],</c->
 <c- p>[</c-><c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>],</c->
 <c- p>[</c-><c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>],</c->
 <c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>],</c->
 <c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>],</c->
<c- p>];</c->

<c- a>function</c-> wrapX<c- p>(</c->x<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c->x <c- o>&lt;</c-> <c- mi>0</c-><c- p>)</c-> <c- k>return</c-> wrapX<c- p>(</c->x <c- o>+</c-> map<c- p>[</c-><c- mi>0</c-><c- p>].</c->length<c- p>);</c->
  <c- k>if</c-> <c- p>(</c->x <c- o>>=</c-> map<c- p>[</c-><c- mi>0</c-><c- p>].</c->length<c- p>)</c-> <c- k>return</c-> wrapX<c- p>(</c->x <c- o>-</c-> map<c- p>[</c-><c- mi>0</c-><c- p>].</c->length<c- p>);</c->
  <c- k>return</c-> x<c- p>;</c->
<c- p>}</c->

<c- a>function</c-> wrapY<c- p>(</c->y<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c->y <c- o>&lt;</c-> <c- mi>0</c-><c- p>)</c-> <c- k>return</c-> wrapY<c- p>(</c->y <c- o>+</c-> map<c- p>.</c->length<c- p>);</c->
  <c- k>if</c-> <c- p>(</c->y <c- o>>=</c-> map<c- p>[</c-><c- mi>0</c-><c- p>].</c->length<c- p>)</c-> <c- k>return</c-> wrapY<c- p>(</c->y <c- o>-</c-> map<c- p>.</c->length<c- p>);</c->
  <c- k>return</c-> y<c- p>;</c->
<c- p>}</c->

<c- a>function</c-> wrap<c- p>(</c->val<c- p>,</c-> min<c- p>,</c-> max<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c->val <c- o>&lt;</c-> min<c- p>)</c->
    <c- k>return</c-> val <c- o>+</c-> <c- p>(</c->max<c- o>-</c->min<c- p>)</c-><c- o>+</c-><c- mi>1</c-><c- p>;</c->
  <c- k>if</c-> <c- p>(</c->val <c- o>></c-> max<c- p>)</c->
    <c- k>return</c-> val <c- o>-</c-> <c- p>(</c->max<c- o>-</c->min<c- p>)</c-><c- o>-</c-><c- mi>1</c-><c- p>;</c->
  <c- k>return</c-> val<c- p>;</c->
<c- p>}</c->

<c- a>function</c-> sendMapData<c- p>(</c->viewer<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> data <c- o>=</c-> <c- t>''</c-><c- p>;</c->
  <c- k>for</c-> <c- p>(</c-><c- a>var</c-> y <c- o>=</c-> viewer<c- p>.</c->y<c- o>-</c-><c- mi>1</c-><c- p>;</c-> y <c- o>&lt;=</c-> viewer<c- p>.</c->y<c- o>+</c-><c- mi>1</c-><c- p>;</c-> y <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
    <c- k>for</c-> <c- p>(</c-><c- a>var</c-> x <c- o>=</c-> viewer<c- p>.</c->x<c- o>-</c-><c- mi>1</c-><c- p>;</c-> x <c- o>&lt;=</c-> viewer<c- p>.</c->x<c- o>+</c-><c- mi>1</c-><c- p>;</c-> x <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
      <c- k>if</c-> <c- p>(</c->data <c- o>!=</c-> <c- t>''</c-><c- p>)</c->
        data <c- o>+=</c-> <c- t>','</c-><c- p>;</c->
      data <c- o>+=</c-> map<c- p>[</c->wrap<c- p>(</c->y<c- p>,</c-> <c- mi>0</c-><c- p>,</c-> map<c- p>[</c-><c- mi>0</c-><c- p>].</c->length<c- o>-</c-><c- mi>1</c-><c- p>)][</c->wrap<c- p>(</c->x<c- p>,</c-> <c- mi>0</c-><c- p>,</c-> map<c- p>.</c->length<c- o>-</c-><c- mi>1</c-><c- p>)];</c->
    <c- p>}</c->
  <c- p>}</c->
  viewer<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'map '</c-> <c- o>+</c-> data<c- p>);</c->
<c- p>}</c->

<c- a>var</c-> viewers <c- o>=</c-> <c- p>{};</c->
onconnect <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> name <c- o>=</c-> getNextName<c- p>();</c->
  event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>].</c->_data <c- o>=</c-> <c- p>{</c-> port<c- o>:</c-> event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>],</c-> name<c- o>:</c-> name<c- p>,</c-> x<c- o>:</c-> <c- mi>0</c-><c- p>,</c-> y<c- o>:</c-> <c- mi>0</c-><c- p>,</c-> <c- p>};</c->
  viewers<c- p>[</c->name<c- p>]</c-> <c- o>=</c-> event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>].</c->_data<c- p>;</c->
  event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>].</c->postMessage<c- p>(</c-><c- t>'cfg '</c-> <c- o>+</c-> name<c- p>);</c->
  event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>].</c->onmessage <c- o>=</c-> getMessage<c- p>;</c->
  sendMapData<c- p>(</c->event<c- p>.</c->ports<c- p>[</c-><c- mi>0</c-><c- p>].</c->_data<c- p>);</c->
<c- p>};</c->

<c- a>function</c-> getMessage<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  <c- k>switch</c-> <c- p>(</c->event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>0</c-><c- p>,</c-> <c- mi>4</c-><c- p>))</c-> <c- p>{</c->
    <c- k>case</c-> <c- t>'mov '</c-><c- o>:</c->
      <c- a>var</c-> direction <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>);</c->
      <c- a>var</c-> dx <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
      <c- a>var</c-> dy <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
      <c- k>switch</c-> <c- p>(</c->direction<c- p>)</c-> <c- p>{</c->
        <c- k>case</c-> <c- t>'up'</c-><c- o>:</c-> dy <c- o>=</c-> <c- o>-</c-><c- mi>1</c-><c- p>;</c-> <c- k>break</c-><c- p>;</c->
        <c- k>case</c-> <c- t>'down'</c-><c- o>:</c-> dy <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- k>break</c-><c- p>;</c->
        <c- k>case</c-> <c- t>'left'</c-><c- o>:</c-> dx <c- o>=</c-> <c- o>-</c-><c- mi>1</c-><c- p>;</c-> <c- k>break</c-><c- p>;</c->
        <c- k>case</c-> <c- t>'right'</c-><c- o>:</c-> dx <c- o>=</c-> <c- mi>1</c-><c- p>;</c-> <c- k>break</c-><c- p>;</c->
      <c- p>}</c->
      event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->x <c- o>=</c-> wrapX<c- p>(</c->event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->x <c- o>+</c-> dx<c- p>);</c->
      event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->y <c- o>=</c-> wrapY<c- p>(</c->event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->y <c- o>+</c-> dy<c- p>);</c->
      sendMapData<c- p>(</c->event<c- p>.</c->target<c- p>.</c->_data<c- p>);</c->
      <c- k>break</c-><c- p>;</c->
    <c- k>case</c-> <c- t>'set '</c-><c- o>:</c->
      <c- a>var</c-> value <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>);</c->
      map<c- p>[</c->event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->y<c- p>][</c->event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->x<c- p>]</c-> <c- o>=</c-> value<c- p>;</c->
      <c- k>for</c-> <c- p>(</c-><c- a>var</c-> viewer <c- k>in</c-> viewers<c- p>)</c->
        sendMapData<c- p>(</c->viewers<c- p>[</c->viewer<c- p>]);</c->
      <c- k>break</c-><c- p>;</c->
    <c- k>case</c-> <c- t>'txt '</c-><c- o>:</c->
      <c- a>var</c-> name <c- o>=</c-> event<c- p>.</c->target<c- p>.</c->_data<c- p>.</c->name<c- p>;</c->
      <c- a>var</c-> message <c- o>=</c-> event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>);</c->
      <c- k>for</c-> <c- p>(</c-><c- a>var</c-> viewer <c- k>in</c-> viewers<c- p>)</c->
        viewers<c- p>[</c->viewer<c- p>].</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'txt '</c-> <c- o>+</c-> name <c- o>+</c-> <c- t>' '</c-> <c- o>+</c-> message<c- p>);</c->
      <c- k>break</c-><c- p>;</c->
    <c- k>case</c-> <c- t>'msg '</c-><c- o>:</c->
      <c- a>var</c-> party1 <c- o>=</c-> event<c- p>.</c->target<c- p>.</c->_data<c- p>;</c->
      <c- a>var</c-> party2 <c- o>=</c-> viewers<c- p>[</c->event<c- p>.</c->data<c- p>.</c->substr<c- p>(</c-><c- mi>4</c-><c- p>).</c->split<c- p>(</c-><c- t>' '</c-><c- p>,</c-> <c- mi>1</c-><c- p>)[</c-><c- mi>0</c-><c- p>]];</c->
      <c- k>if</c-> <c- p>(</c->party2<c- p>)</c-> <c- p>{</c->
        <c- a>var</c-> channel <c- o>=</c-> <c- k>new</c-> MessageChannel<c- p>();</c->
        party1<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'msg '</c-> <c- o>+</c-> party2<c- p>.</c->name<c- p>,</c-> <c- p>[</c->channel<c- p>.</c->port1<c- p>]);</c->
        party2<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'msg '</c-> <c- o>+</c-> party1<c- p>.</c->name<c- p>,</c-> <c- p>[</c->channel<c- p>.</c->port2<c- p>]);</c->
      <c- p>}</c->
      <c- k>break</c-><c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <p>Connecting to multiple pages. The script uses the <code class="idl"><a data-link-type="idl" href="#handler-sharedworkerglobalscope-onconnect" id="ref-for-handler-sharedworkerglobalscope-onconnect">onconnect</a></code> event listener
to listen for multiple connections.</p>
   <p>Direct channels. When the worker receives a "msg" message from one viewer
naming another viewer, it sets up a direct connection between the two, so
that the two viewers can communicate directly without the worker having to
proxy all the messages.</p>
   <p><a href="https://www.whatwg.org/demos/workers/multiviewer/page.html"> View this example online. </a></p>
   <h4 class="heading settled" data-level="1.2.5" id="examples-5"><span class="secno">1.2.5. </span><span class="content">Delegation</span><a class="self-link" href="#examples-5"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>With multicore CPUs becoming prevalent, one way to obtain better performance
is to split computationally expensive tasks amongst multiple workers. In this
example, a computationally expensive task that is to be performed for every
number from 1 to 10,000,000 is farmed out to ten subworkers.</p>
   <p>The main page is as follows, it just reports the result:</p>
<pre class="example lang-html highlight" id="example-3457e0c3"><a class="self-link" href="#example-3457e0c3"></a><c- cp>&lt;!DOCTYPE HTML></c->
<c- p>&lt;</c-><c- f>html</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>head</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>title</c-><c- p>></c->Worker example: Multicore computation<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>head</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>p</c-><c- p>></c->Result: <c- p>&lt;</c-><c- f>output</c-> <c- e>id</c-><c- o>=</c-><c- s>"result"</c-><c- p>>&lt;/</c-><c- f>output</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>script</c-><c- p>></c->
   <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'worker.js'</c-><c- p>);</c->
   worker<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
     document<c- p>.</c->getElementById<c- p>(</c-><c- t>'result'</c-><c- p>).</c->textContent <c- o>=</c-> event<c- p>.</c->data<c- p>;</c->
   <c- p>};</c->
  <c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
 <c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>html</c-><c- p>></c->
</pre>
   <p>The worker itself is as follows:</p>
<pre class="example lang-js highlight" id="example-3a4d429b"><a class="self-link" href="#example-3a4d429b"></a><c- c1>// Settings</c->
<c- a>var</c-> num_workers <c- o>=</c-> <c- mi>10</c-><c- p>;</c->
<c- a>var</c-> items_per_worker <c- o>=</c-> <c- mi>1000000</c-><c- p>;</c->

<c- c1>// Start the workers</c->
<c- a>var</c-> result <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
<c- a>var</c-> pending_workers <c- o>=</c-> num_workers<c- p>;</c->
<c- k>for</c-> <c- p>(</c-><c- a>var</c-> i <c- o>=</c-> <c- mi>0</c-><c- p>;</c-> i <c- o>&lt;</c-> num_workers<c- p>;</c-> i <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'core.js'</c-><c- p>);</c->
  worker<c- p>.</c->postMessage<c- p>(</c->i <c- o>*</c-> items_per_worker<c- p>);</c->
  worker<c- p>.</c->postMessage<c- p>((</c->i<c- o>+</c-><c- mi>1</c-><c- p>)</c-> <c- o>*</c-> items_per_worker<c- p>);</c->
  worker<c- p>.</c->onmessage <c- o>=</c-> storeResult<c- p>;</c->
<c- p>}</c->

<c- c1>// handle the results</c->
<c- a>function</c-> storeResult<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  result <c- o>+=</c-> <c- mi>1</c-><c- o>*</c->event<c- p>.</c->data<c- p>;</c->
  pending_workers <c- o>-=</c-> <c- mi>1</c-><c- p>;</c->
  <c- k>if</c-> <c- p>(</c->pending_workers <c- o>&lt;=</c-> <c- mi>0</c-><c- p>)</c->
    postMessage<c- p>(</c->result<c- p>);</c-> <c- c1>// Finished!</c->
<c- p>}</c->
</pre>
   <p>It consists of a loop to start the subworkers, and then a handler that waits
for all the subworkers to respond.</p>
   <p>The subworkers are implemented as follows:</p>
<pre class="example lang-js highlight" id="example-ebd0768b"><a class="self-link" href="#example-ebd0768b"></a><c- a>var</c-> start<c- p>;</c->
onmessage <c- o>=</c-> getStart<c- p>;</c->
<c- a>function</c-> getStart<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  start <c- o>=</c-> <c- mi>1</c-><c- o>*</c->event<c- p>.</c->data<c- p>;</c->
  <c- p>{{</c->onmessage<c- p>}}</c-> <c- o>=</c-> getEnd<c- p>;</c->
<c- p>}</c->

<c- a>var</c-> end<c- p>;</c->
<c- a>function</c-> getEnd<c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  end <c- o>=</c-> <c- mi>1</c-><c- o>*</c->event<c- p>.</c->data<c- p>;</c->
  <c- p>{{</c->onmessage<c- p>}}</c-> <c- o>=</c-> <c- kc>null</c-><c- p>;</c->
  work<c- p>();</c->
<c- p>}</c->

<c- a>function</c-> work<c- p>()</c-> <c- p>{</c->
  <c- a>var</c-> result <c- o>=</c-> <c- mi>0</c-><c- p>;</c->
  <c- k>for</c-> <c- p>(</c-><c- a>var</c-> i <c- o>=</c-> start<c- p>;</c-> i <c- o>&lt;</c-> end<c- p>;</c-> i <c- o>+=</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
    <c- c1>// Perform some complex calculation here</c->
    result <c- o>+=</c-> <c- mi>1</c-><c- p>;</c->
  <c- p>}</c->
  postMessage<c- p>(</c->result<c- p>);</c->
  close<c- p>();</c->
<c- p>}</c->
</pre>
   <p>They receive two numbers in two events, perform the computation for the range
of numbers thus specified, and then report the result back to the parent.</p>
   <p><a href="https://www.whatwg.org/demos/workers/multicore/page.html"> View this example online. </a></p>
   <h3 class="heading settled" data-level="1.3" id="tutorials"><span class="secno">1.3. </span><span class="content">Tutorials</span><a class="self-link" href="#tutorials"></a></h3>
   <h4 class="heading settled" data-level="1.3.1" id="tutorial-1"><span class="secno">1.3.1. </span><span class="content">Creating a dedicated worker</span><a class="self-link" href="#tutorial-1"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>Creating a worker requires a URL to a JavaScript file. The <code class="idl"><a data-link-type="idl" href="#dom-worker-worker" id="ref-for-dom-worker-worker">Worker()</a></code> constructor is invoked with the URL to that file as its only argument; a
worker is then created and returned:</p>
<pre class="example lang-js highlight" id="example-72d8b534"><a class="self-link" href="#example-72d8b534"></a><c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'helper.js'</c-><c- p>);</c->
</pre>
   <p>If you want your worker script to be interpreted as a <code class="idl"><a data-link-type="idl">module script</a></code> instead of the default <code class="idl"><a data-link-type="idl">classic script</a></code>, you need to use a slightly
different signature:</p>
<pre class="example lang-js highlight" id="example-02747ce3"><a class="self-link" href="#example-02747ce3"></a><c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> Worker<c- p>(</c-><c- t>'helper.js'</c-><c- p>,</c-> <c- p>{</c-> type<c- o>:</c-> <c- u>"module"</c-> <c- p>});</c->
</pre>
   <h4 class="heading settled" data-level="1.3.2" id="tutorial-2"><span class="secno">1.3.2. </span><span class="content">Communicating with a dedicated worker</span><a class="self-link" href="#tutorial-2"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>Dedicated workers use <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport">MessagePort</a></code> objects behind the scenes, and thus
support all the same features, such as sending structured data, transferring
binary data, and transferring other ports.</p>
   <p>To receive messages from a dedicated worker, use the <code class="idl"><a data-link-type="idl" href="#handler-dedicatedworkerglobalscope-onmessage" id="ref-for-handler-dedicatedworkerglobalscope-onmessage①">onmessage</a></code> <code class="idl"><a data-link-type="idl">event
handler IDL attribute</a></code> on the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker④">Worker</a></code> object:</p>
<pre class="example lang-js highlight" id="example-3839641d"><a class="self-link" href="#example-3839641d"></a>worker<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c-> <c- p>...</c-> <c- p>};</c->
</pre>
   <p>You can also use the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener" id="ref-for-dom-eventtarget-addeventlistener①">addEventListener()</a></code> method.</p>
   <p class="note" role="note"> The implicit <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①">MessagePort</a></code> used by dedicated workers has its port message
queue implicitly enabled when it is created, so there is no equivalent to the
MessagePort interface’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-messageport-start" id="ref-for-dom-messageport-start">start()</a></code> method on the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker⑤">Worker</a></code> interface. </p>
   <p>To send data to a worker, use the <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-postmessage" id="ref-for-dom-dedicatedworkerglobalscope-postmessage①">postMessage()</a></code> method. Structured data
can be sent over this communication channel. To send <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer">ArrayBuffer</a></code> objects
efficiently (by transferring them rather than cloning them), list them in an
array in the second argument.</p>
<pre class="example lang-js highlight" id="example-97c14c25"><a class="self-link" href="#example-97c14c25"></a>worker<c- p>.</c->postMessage<c- p>({</c->
  operation<c- o>:</c-> <c- t>'find-edges'</c-><c- p>,</c->
  input<c- o>:</c-> buffer<c- p>,</c-> <c- c1>// An {{ArrayBuffer}} object</c->
  threshold<c- o>:</c-> <c- mf>0.6</c-><c- p>,</c->
<c- p>},</c-> <c- p>[</c->buffer<c- p>]);</c->
</pre>
   <p>To receive a message inside the worker, the <code class="idl"><a data-link-type="idl" href="#handler-dedicatedworkerglobalscope-onmessage" id="ref-for-handler-dedicatedworkerglobalscope-onmessage②">onmessage</a></code> event handler IDL
attribute is used.</p>
<pre class="example lang-js highlight" id="example-808cf9ac"><a class="self-link" href="#example-808cf9ac"></a>onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c-> <c- p>...</c-> <c- p>};</c->
</pre>
   <p>You can again also use the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener" id="ref-for-dom-eventtarget-addeventlistener②">addEventListener()</a></code> method.</p>
   <p>In either case, the data is provided in the event object’s data attribute.</p>
   <p>To send messages back, you again use postMessage(). It supports the
structured data in the same manner.</p>
<pre class="example lang-js highlight" id="example-63961be0"><a class="self-link" href="#example-63961be0"></a>postMessage<c- p>(</c->event<c- p>.</c->data<c- p>.</c->input<c- p>,</c-> <c- p>[</c->event<c- p>.</c->data<c- p>.</c->input<c- p>]);</c-> <c- c1>// Transfer the buffer back</c->
</pre>
   <h4 class="heading settled" data-level="1.3.3" id="tutorial-3"><span class="secno">1.3.3. </span><span class="content">Shared workers</span><a class="self-link" href="#tutorial-3"></a></h4>
   <p><em>This section is non-normative.</em></p>
   <p>Shared workers are identified by the URL of the script used to create it,
optionally with an explicit name. The name allows multiple instances of a
particular shared worker to be started.</p>
   <p>Shared workers are scoped by <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-origin" id="ref-for-dom-workerlocation-origin">origin</a></code>. Two different sites using the same
names will not collide. However, if a page tries to use the same shared
worker name as another page on the same site, but with a different script
URL, it will fail.</p>
   <p>Creating shared workers is done using the <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-sharedworker" id="ref-for-dom-sharedworker-sharedworker">SharedWorker()</a></code> constructor.
This constructor takes the URL to the script to use for its first argument,
and the name of the worker, if any, as the second argument.</p>
<pre class="example lang-js highlight" id="example-ee49a0bc"><a class="self-link" href="#example-ee49a0bc"></a><c- a>var</c-> worker <c- o>=</c-> <c- k>new</c-> SharedWorker<c- p>(</c-><c- t>'service.js'</c-><c- p>);</c->
</pre>
   <p>Communicating with shared workers is done with explicit <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport②">MessagePort</a></code> objects. The object returned by the <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-sharedworker" id="ref-for-dom-sharedworker-sharedworker①">SharedWorker()</a></code> constructor holds a
reference to the <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-port" id="ref-for-dom-sharedworker-port">port</a></code> on its port attribute.</p>
<pre class="example lang-js highlight" id="example-8bcf2b2c"><a class="self-link" href="#example-8bcf2b2c"></a>worker<c- p>.</c->port<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c-> <c- p>...</c-> <c- p>};</c->
worker<c- p>.</c->port<c- p>.</c->postMessage<c- p>(</c-><c- t>'some message'</c-><c- p>);</c->
worker<c- p>.</c->port<c- p>.</c->postMessage<c- p>({</c-> foo<c- o>:</c-> <c- t>'structured'</c-><c- p>,</c-> bar<c- o>:</c-> <c- p>[</c-><c- t>'data'</c-><c- p>,</c-> <c- t>'also'</c-><c- p>,</c-> <c- t>'possible'</c-><c- p>]});</c->
</pre>
   <p>Inside the shared worker, new clients of the worker are announced using the
connect event. The port for the new client is given by the event object’s
source attribute.</p>
<pre class="example lang-js highlight" id="example-8021aff3"><a class="self-link" href="#example-8021aff3"></a>onconnect <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  <c- a>var</c-> newPort <c- o>=</c-> event<c- p>.</c->source<c- p>;</c->
  <c- c1>// Setup a listener</c->
  newPort<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c-> <c- p>...</c-> <c- p>};</c->
  <c- c1>// Send a message back to the port</c->
  newPort<c- p>.</c->postMessage<c- p>(</c-><c- t>'ready!'</c-><c- p>);</c-> <c- c1>// Can also send structured data</c->
<c- p>};</c->
</pre>
   <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <p>The construction "a Foo object", where Foo is actually an interface, is
sometimes used instead of the more accurate "an object implementing the
interface Foo".</p>
   <p>The term DOM is used to refer to the API set made available to scripts in Web
applications, and does not necessarily imply the existence of an actual
Document object or of any other Node objects as defined in the DOM
specifications. <a data-link-type="biblio" href="#biblio-dom">[DOM]</a></p>
   <p>An IDL attribute is said to be getting when its value is being retrieved
(e.g. by author script), and is said to be setting when a new value is
assigned to it.</p>
   <p>The term "JavaScript" is used to refer to ECMA262, rather than the official
term ECMAScript, since the term JavaScript is more widely known. <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a></p>
   <h2 class="heading settled" data-level="3" id="infrastructure"><span class="secno">3. </span><span class="content">Infrastructure</span><a class="self-link" href="#infrastructure"></a></h2>
   <p>There are two kinds of workers; dedicated workers, and shared workers.
Dedicated workers, once created, are linked to their creator; but message
ports can be used to communicate from a dedicated worker to multiple other
browsing contexts or workers. Shared workers, on the other hand, are named,
and once created any script running in the same origin can obtain a reference
to that worker and communicate with it.</p>
   <h3 class="heading settled" data-level="3.1" id="global-scope"><span class="secno">3.1. </span><span class="content">The global scope</span><a class="self-link" href="#global-scope"></a></h3>
   <p>The global scope is the "inside" of a worker.</p>
   <h4 class="heading settled" data-level="3.1.1" id="workerglobalscope"><span class="secno">3.1.1. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①">WorkerGlobalScope</a></code> common interface</span><a class="self-link" href="#workerglobalscope"></a></h4>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Worker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="workerglobalscope①"><code><c- g>WorkerGlobalScope</c-></code></dfn> : <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#workerglobalscope①" id="ref-for-workerglobalscope①①"><c- n>WorkerGlobalScope</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="WorkerGlobalScope" id="dom-workerglobalscope-self"><code><c- g>self</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#workerlocation" id="ref-for-workerlocation"><c- n>WorkerLocation</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="WorkerLocation" id="dom-workerglobalscope-location"><code><c- g>location</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator"><c- n>WorkerNavigator</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="WorkerNavigator" id="dom-workerglobalscope-navigator"><code><c- g>navigator</c-></code></dfn>;
  <c- b>void</c-> <dfn class="idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="method" data-export data-lt="importScripts(...urls)|importScripts()" id="dom-workerglobalscope-importscripts"><code><c- g>importScripts</c-></code><a class="self-link" href="#dom-workerglobalscope-importscripts"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a>... <dfn class="idl-code" data-dfn-for="WorkerGlobalScope/importScripts(...urls)" data-dfn-type="argument" data-export id="dom-workerglobalscope-importscripts-urls-urls"><code><c- g>urls</c-></code><a class="self-link" href="#dom-workerglobalscope-importscripts-urls-urls"></a></dfn>);
  <c- b>void</c-> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="method" data-export data-lt="close()" id="dom-workerglobalscope-close"><code><c- g>close</c-></code></dfn>();

  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#onerroreventhandler" id="ref-for-onerroreventhandler"><c- n>OnErrorEventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="OnErrorEventHandler" href="#handler-workerglobalscope-onerror" id="ref-for-handler-workerglobalscope-onerror"><c- g>onerror</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onlanguagechange" id="ref-for-handler-workerglobalscope-onlanguagechange"><c- g>onlanguagechange</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onoffline" id="ref-for-handler-workerglobalscope-onoffline"><c- g>onoffline</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler②"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-ononline" id="ref-for-handler-workerglobalscope-ononline"><c- g>ononline</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler③"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onrejectionhandled" id="ref-for-handler-workerglobalscope-onrejectionhandled"><c- g>onrejectionhandled</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler④"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onunhandledrejection" id="ref-for-handler-workerglobalscope-onunhandledrejection"><c- g>onunhandledrejection</c-></a>;
};
</pre>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerglobalscope-self" id="ref-for-dom-workerglobalscope-self">self</a></code> attribute must return the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②">WorkerGlobalScope</a></code> object itself.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerglobalscope-location" id="ref-for-dom-workerglobalscope-location">location</a></code> attribute must return the <code class="idl"><a data-link-type="idl" href="#workerlocation" id="ref-for-workerlocation①">WorkerLocation</a></code> object created for
the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③">WorkerGlobalScope</a></code> object when the worker was creatored. It represents
the absolute URL of the script that was used to initialise the worker, after
any redirects.</p>
   <p>When a script invokes the <code class="idl"><a data-link-type="idl" href="#dom-workerglobalscope-close" id="ref-for-dom-workerglobalscope-close">close()</a></code> method on a <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①④">WorkerGlobalScope</a></code> object,
the user agent must run the following steps (atomically):</p>
   <ol>
    <li data-md>
     <p>Discard any tasks that have been added to the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑤">WorkerGlobalScope</a></code> object’s event loop’s task queues.</p>
    <li data-md>
     <p>Set the worker’s <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑥">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl">closing</a></code> flag to true.
(This prevents any further tasks from being queued.)</p>
   </ol>
   <p>The following are the event handlers (and their corresponding event handler
event types) that must be supported, as event handler IDL attributes, by
objects implementing the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑦">WorkerGlobalScope</a></code> interface:</p>
   <table>
    <thead>
     <tr>
      <th> <span title="event handlers">Event handler</span> 
      <th> <span>Event handler event type</span> 
    <tbody>
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onerror" id="handler-workerglobalscope-onerror" title="handler-WorkerGlobalScope-onerror"> <code>onerror</code> </dfn> 
      <td> <code title="event-error">error</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onlanguagechange" id="handler-workerglobalscope-onlanguagechange" title="handler-WorkerGlobalScope-onlanguagechange"> <code>onlanguagechange</code> </dfn> 
      <td> <code title="event-languagechange">languagechange</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onoffline" id="handler-workerglobalscope-onoffline" title="handler-WorkerGlobalScope-onoffline"> <code>onoffline</code> </dfn> 
      <td> <code title="event-offline">offline</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="ononline" id="handler-workerglobalscope-ononline" title="handler-WorkerGlobalScope-ononline"> <code>ononline</code> </dfn> 
      <td> <code title="event-online">online</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onrejectionhandled" id="handler-workerglobalscope-onrejectionhandled" title="handler-WorkerGlobalScope-onrejectionhandled"> <code>onrejectionhandled</code> </dfn> 
      <td> <code title="event-rejectionhandled">rejectionhandled</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onunhandledrejection" id="handler-workerglobalscope-onunhandledrejection" title="handler-WorkerGlobalScope-onunhandledrejection"> <code>onunhandledrejection</code> </dfn> 
      <td> <code title="event-rejectionhandled">unhandledrejection</code> 
   </table>
   <p class="note" role="note"> For <code>data:</code> URLs, this is the origin specified by the entry
  settings object when the constructor was called. For other URLs, this is the
  origin of the value of the absolute URL given in the worker’s location
  attribute. </p>
   <h4 class="heading settled" data-level="3.1.2" id="dedicated-workers"><span class="secno">3.1.2. </span><span class="content">Dedicated workers and the <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code> interface</span><a class="self-link" href="#dedicated-workers"></a></h4>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global"><c- g>Global</c-></a>=<a class="n" data-link-type="idl-name" href="#worker" id="ref-for-worker⑥"><c- n>Worker</c-></a>,<a class="idl-code" data-link-type="extended-attribute"><c- g>DedicatedWorker</c-></a>,<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
/*sealed*/ <c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="dedicatedworkerglobalscope"><code><c- g>DedicatedWorkerGlobalScope</c-></code></dfn> : <a class="n" data-link-type="idl-name" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑧"><c- n>WorkerGlobalScope</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="DedicatedWorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-dedicatedworkerglobalscope-name"><code><c- g>name</c-></code></dfn>;

  <c- b>void</c-> <dfn class="dfn-paneled idl-code" data-dfn-for="DedicatedWorkerGlobalScope" data-dfn-type="method" data-export data-lt="postMessage(message, transfer)|postMessage(message)" id="dom-dedicatedworkerglobalscope-postmessage"><code><c- g>postMessage</c-></code></dfn>(<c- b>any</c-> <dfn class="idl-code" data-dfn-for="DedicatedWorkerGlobalScope/postMessage(message, transfer), DedicatedWorkerGlobalScope/postMessage(message)" data-dfn-type="argument" data-export id="dom-dedicatedworkerglobalscope-postmessage-message-transfer-message"><code><c- g>message</c-></code><a class="self-link" href="#dom-dedicatedworkerglobalscope-postmessage-message-transfer-message"></a></dfn>, <c- b>optional</c-> <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name"><c- n>Transferable</c-></a>> <dfn class="idl-code" data-dfn-for="DedicatedWorkerGlobalScope/postMessage(message, transfer), DedicatedWorkerGlobalScope/postMessage(message)" data-dfn-type="argument" data-export id="dom-dedicatedworkerglobalscope-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code><a class="self-link" href="#dom-dedicatedworkerglobalscope-postmessage-message-transfer-transfer"></a></dfn>);

  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑤"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-dedicatedworkerglobalscope-onmessage" id="ref-for-handler-dedicatedworkerglobalscope-onmessage③"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑥"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-dedicatedworkerglobalscope-onmessageerror" id="ref-for-handler-dedicatedworkerglobalscope-onmessageerror"><c- g>onmessageerror</c-></a>;
};
</pre>
   <p><code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope①">DedicatedWorkerGlobalScope</a></code> objects act as if they had an implicit <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport③">MessagePort</a></code> associated with them. This port is part of a channel that is
set up when the worker is created, but it is not exposed. This object must
never be garbage collected before the <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope②">DedicatedWorkerGlobalScope</a></code> object.</p>
   <p>All messages received by that port must immediately be retargeted at the
DedicatedWorkerGlobalScope object.</p>
   <dl class="note">
    <dt><var>dedicatedWorkerGlobal</var> . <code>name</code>
    <dd> Returns dedicatedWorkerGlobal’s <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name">name</a></code>, i.e. the value given to the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker⑦">Worker</a></code> constructor. Primarily useful for debugging. 
    <dt><var>dedicatedWorkerGlobal</var> . <code>postMessage(message [, transfer])</code>
    <dd> Clones message and transmits it to the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker⑧">Worker</a></code> object associated with
    dedicatedWorkerGlobal.transfer can be passed as a list of objects that
    are to be transferred rather than cloned. 
   </dl>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name①">name</a></code> attribute must return the <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope③">DedicatedWorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name②">name</a></code>. Its value the name given to the worker using the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker⑨">Worker</a></code> constructor, used primarily for debugging purposes.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-postmessage" id="ref-for-dom-dedicatedworkerglobalscope-postmessage②">postMessage()</a></code> method on <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope④">DedicatedWorkerGlobalScope</a></code> objects must
act as if, when invoked, it immediately invoked the method of the same name on
the port, with the same arguments, and returned the same return value.</p>
   <p>The following are the <code class="idl"><a data-link-type="idl">event handlers</a></code> (and their corresponding event handler
event types) that must be supported, as <code class="idl"><a data-link-type="idl">event handler IDL attributes</a></code>, by
objects implementing the <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope⑤">DedicatedWorkerGlobalScope</a></code> interface:</p>
   <table>
    <thead>
     <tr>
      <th> <span title="event handlers">Event handler</span> 
      <th> <span>Event handler event type</span> 
    <tbody>
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="DedicatedWorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onmessage" id="handler-dedicatedworkerglobalscope-onmessage" title="handler-DedicatedWorkerGlobalScope-onmessage"> <code>onmessage</code> </dfn> 
      <td> <code title="event-message">message</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="DedicatedWorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onmessageerror" id="handler-dedicatedworkerglobalscope-onmessageerror" title="handler-DedicatedWorkerGlobalScope-onmessageerror"> <code>onmessageerror</code> </dfn> 
      <td> <code title="event-messageerror">messageerror</code> 
   </table>
   <p>For the purposes of the <code class="idl"><a data-link-type="idl">application cache</a></code> networking model, a dedicated
worker is an extension of the <code class="idl"><a data-link-type="idl">cache host</a></code> from which it was created.</p>
   <h4 class="heading settled" data-level="3.1.3" id="shared-workers"><span class="secno">3.1.3. </span><span class="content">Shared workers and the <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope">SharedWorkerGlobalScope</a></code> interface</span><a class="self-link" href="#shared-workers"></a></h4>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global①"><c- g>Global</c-></a>=<a class="n" data-link-type="idl-name" href="#worker" id="ref-for-worker①⓪"><c- n>Worker</c-></a>,<a class="idl-code" data-link-type="extended-attribute"><c- g>SharedWorker</c-></a>,<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=<c- n>SharedWorker</c->]
/*sealed*/ <c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedworkerglobalscope"><code><c- g>SharedWorkerGlobalScope</c-></code></dfn> : <a class="n" data-link-type="idl-name" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑨"><c- n>WorkerGlobalScope</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="SharedWorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-sharedworkerglobalscope-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-sharedworkerglobalscope-name"></a></dfn>;

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/offline.html#applicationcache" id="ref-for-applicationcache"><c- n>ApplicationCache</c-></a> <dfn class="idl-code" data-dfn-for="SharedWorkerGlobalScope" data-dfn-type="attribute" data-export data-readonly data-type="ApplicationCache" id="dom-sharedworkerglobalscope-applicationcache"><code><c- g>applicationCache</c-></code><a class="self-link" href="#dom-sharedworkerglobalscope-applicationcache"></a></dfn>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑦"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-sharedworkerglobalscope-onconnect" id="ref-for-handler-sharedworkerglobalscope-onconnect①"><c- g>onconnect</c-></a>;
};
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①">SharedWorkerGlobalScope</a></code> object has an associated constructor origin,
and constructor url. They are initialized when the <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope②">SharedWorkerGlobalScope</a></code> object is created, in the run a worker algorithm.</p>
   <p>Shared workers receive message ports through <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-workerglobalscope-connect" id="ref-for-event-workerglobalscope-connect">connect</a></code> events on their <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope③">SharedWorkerGlobalScope</a></code> object for each connection.</p>
   <dl class="note">
    <dt><var>sharedWorkerGlobal</var> . <code>name</code>
    <dd> Returns sharedWorkerGlobal’s <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name③">name</a></code>, i.e. the value given to the <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker">SharedWorker</a></code> constructor. Multiple <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker①">SharedWorker</a></code> objects can
    correspond to the same shared worker (and <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope④">SharedWorkerGlobalScope</a></code>),
    by reusing the same name. 
   </dl>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name④">name</a></code> attribute must return the object’s name.
Its value represents the name that can be used to obtain a reference to the
worker using the <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker②">SharedWorker</a></code> constructor.</p>
   <p>The following are the event handlers (and their corresponding event handler
event types) that must be supported, as event handler IDL attributes, by
objects implementing the <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope⑤">SharedWorkerGlobalScope</a></code> interface:</p>
   <table>
    <thead>
     <tr>
      <th> <span title="event handlers">Event handler</span> 
      <th> <span>Event handler event type</span> 
    <tbody>
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedWorkerGlobalScope" data-dfn-type="attribute" data-export data-lt="onconnect" id="handler-sharedworkerglobalscope-onconnect" title="handler-SharedWorkerGlobalScope-onconnect"> <code>onconnect</code> </dfn> 
      <td> <code title="event-connect">connect</code> 
   </table>
   <p>For the purposes of the application cache networking model, a shared worker
is its own cache host. The run a worker algorithm takes care of associating
the worker with an application cache.</p>
   <p class="note" role="note"> The applicationCache attribute returns the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/offline.html#applicationcache" id="ref-for-applicationcache①">ApplicationCache</a></code> object for the
worker. </p>
   <h3 class="heading settled" data-level="3.2" id="event-loop"><span class="secno">3.2. </span><span class="content">The event loop</span><a class="self-link" href="#event-loop"></a></h3>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①⓪">WorkerGlobalScope</a></code> object has a distinct event loop, separate from
those used by units of related similar-origin browsing contexts. This event
loop has no associated browsing context, and its task queues only have events,
callbacks, and networking activity as tasks. These event loops are created by
the run a worker algorithm.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①①">WorkerGlobalScope</a></code> object also has a <dfn data-dfn-type="dfn" data-noexport id="closing">closing<a class="self-link" href="#closing"></a></dfn> flag, which
must initially be false, but which can get set to true by the algorithms in the
processing model section below.</p>
   <p>Once the WorkerGlobalScope’s <code class="idl"><a data-link-type="idl">closing</a></code> flag is set to true, the event loop’s
task queues must discard any further tasks that would be added to them (tasks
already on the queue are unaffected except where otherwise specified).
Effectively, once the <code class="idl"><a data-link-type="idl">closing</a></code> flag is true, timers stop firing,
notifications for all pending asynchronous operations are dropped, etc.</p>
   <h3 class="heading settled" data-level="3.3" id="worker-lifetime"><span class="secno">3.3. </span><span class="content">The worker’s lifetime</span><a class="self-link" href="#worker-lifetime"></a></h3>
   <p>Workers communicate with other workers and with browsing contexts through
message channels and their <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport④">MessagePort</a></code> objects.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①②">WorkerGlobalScope</a></code> <em>worker global scope</em> has a list of
the worker’s ports, which consists of all the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑤">MessagePort</a></code> objects that
are entangled with another port and that have one (but only one) port owned
by worker global scope. This list includes the implicit <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑥">MessagePort</a></code> in
the case of dedicated workers.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①③">WorkerGlobalScope</a></code> also has a list of the worker’s workers. Initially
this list is empty; it is populated when the worker creates or obtains
further workers.</p>
   <p>Finally, each <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①④">WorkerGlobalScope</a></code> also has a list of the worker’s Documents.
Initially this list is empty; it is populated when the worker is created.</p>
   <p>Whenever a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> d is added to the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>s, the user
agent must, for each worker q in the list of the worker’s workers whose list
of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code>s  does not contain d, add d to q’s <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①⑤">WorkerGlobalScope</a></code> owner’s list of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code>s.</p>
   <p>Whenever a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code> object is discarded, it must be removed from the list
of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code>s of each worker whose list contains that <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code>.</p>
   <p>Given a <code class="idl"><a data-link-type="idl">environment settings object</a></code> o when creating or obtaining a worker,
the list of relevant <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑦">Document</a></code> objects to add depends on the type of
global object specified by o’s. If o specifies a <code class="idl"><a data-link-type="idl">global object</a></code> that is a
WorkerGlobalScope object (i.e. if we are creating a nested worker), then
the relevant <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑧">Document</a></code>s are the the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑨">Document</a></code>s  of the <code class="idl"><a data-link-type="idl">global object</a></code> specified by o. Otherwise, o specifies a <code class="idl"><a data-link-type="idl">global object</a></code> that is a Window object, and the relevant <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⓪">Document</a></code> is just the <code class="idl"><a data-link-type="idl">responsible document</a></code> specified by o.</p>
   <p>A worker is said to be a permissible worker if its list of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①①">Document</a></code>s is not empty or:</p>
   <ul>
    <li data-md>
     <p>its <code class="idl"><a data-link-type="idl">owner set</a></code> has been <code class="idl"><a data-link-type="idl">empty</a></code> for no more than a short user-agent-defined timeout value,</p>
    <li data-md>
     <p>its <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①⑥">WorkerGlobalScope</a></code> object is a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope⑥">SharedWorkerGlobalScope</a></code> object (i.e., the worker is a shared worker), <b>and</b></p>
    <li data-md>
     <p>the user agent has a <code class="idl"><a data-link-type="idl">browsing context</a></code> whose <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①②">Document</a></code> is not <code class="idl"><a data-link-type="idl">completely loaded</a></code>.</p>
   </ul>
   <p class="note" role="note"> The second part of this definition allows a shared worker to survive for
  a short time while a page is loading, in case that page is going to contact
  the shared worker again. This can be used by user agents as a way to
  avoid the cost of restarting a shared worker used by a site when the
  user is navigating from page to page within that site. </p>
   <p>A worker is said to be an active needed worker if any of the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①③">Document</a></code> objects in the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①④">Document</a></code>s are fully active.</p>
   <p>A worker is said to be a protected worker if it is an active needed worker
and either it has outstanding timers, database transactions, or network
connections, or its list of the worker’s ports is not empty, or its <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①⑦">WorkerGlobalScope</a></code> is actually a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope⑦">SharedWorkerGlobalScope</a></code> object (i.e.
the worker is a shared worker).</p>
   <p>A worker is said to be a suspendable worker if it is not an active needed
worker but it is a permissible worker.</p>
   <h3 class="heading settled" data-level="3.4" id="processing-model"><span class="secno">3.4. </span><span class="content">Processing model</span><a class="self-link" href="#processing-model"></a></h3>
   <p>When a user agent is to <dfn data-dfn-type="dfn" data-noexport id="run-a-worker">run a worker<a class="self-link" href="#run-a-worker"></a></dfn> for a script with URL url
and a script settings object settings object, it must run the following steps:</p>
   <ol>
    <li data-md>
     <p>Create a separate parallel execution environment (i.e. a separate thread
or process or equivalent construct), and run the rest of these steps
asynchronously in that context.</p>
     <p>For the purposes of timing APIs, this is <dfn data-dfn-type="dfn" data-noexport id="the-official-moment-of-creation">the official moment of creation<a class="self-link" href="#the-official-moment-of-creation"></a></dfn> of the worker.</p>
    <li data-md>
     <p>Let <em>worker global scope</em> be the global object specified by settings object.</p>
    <li data-md>
     <p>If <em>worker global scope</em> is actually a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope⑧">SharedWorkerGlobalScope</a></code> object
(i.e. the worker is a shared worker), and there are any relevant
application caches that are identified by a manifest URL with the same
origin as url and that have url as one of their entries, not excluding
entries marked as foreign, then associate the <em>worker global scope</em> with the
most appropriate application cache of those that match.</p>
    <li data-md>
     <p>Attempt to fetch the resource identified by url, from the origin specified
by settings object, using the responsible document specified by settings
object as the referrer source (not the specified API referrer source!),
and with the synchronous flag set and the force same-origin flag set.</p>
     <p>If the attempt fails, then for each <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①①">Worker</a></code> or <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker③">SharedWorker</a></code> object
associated with <em>worker global scope</em>, queue a task to fire a simple event
named error at that object. Abort these steps.</p>
     <p>If the attempt succeeds, then let source be the result of running the
UTF-8 decode algorithm on the script resource.</p>
     <p>Let language be JavaScript.</p>
     <p class="note" role="note"> As with script elements, the MIME type of the script is ignored. Unlike
with script elements, there is no way to override the type. It’s always
assumed to be JavaScript. </p>
    <li data-md>
     <p>In the newly created execution environment, create a JavaScript global
environment whose global object is <em>worker global scope</em>. If worker global
scope is a <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope⑥">DedicatedWorkerGlobalScope</a></code> object, then this is a dedicated
worker environment. Otherwise, <em>worker global scope</em> is a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope⑨">SharedWorkerGlobalScope</a></code> object, and this is a shared worker
environment. (In either case, by definition, it is a worker environment.)</p>
    <li data-md>
     <p>Let script be a new script.</p>
     <p>Obtain the appropriate script execution environment for the scripting
language language from settings object.</p>
     <p>Parse/compile/initialise source using that script execution environment,
as appropriate for language, and thus obtain a code entry-point. If the
script was not compiled successfully, let the code entry-point be a no-op
script, and act as if a corresponding uncaught script error had occurred.</p>
     <p>Let script’s settings object be settings object.</p>
    <li data-md>
     <p>Closing orphan workers: Start monitoring the worker such that no sooner
than it stops being a protected worker, and no later than it stops being a
permissible worker, <em>worker global scope</em>’s <code class="idl"><a data-link-type="idl">closing</a></code> flag is set to true.</p>
    <li data-md>
     <p>Suspending workers: Start monitoring the worker, such that whenever worker
global scope’s <code class="idl"><a data-link-type="idl">closing</a></code> flag is false and the worker is a suspendable
worker, the user agent suspends execution of script in that worker until
such time as either the <code class="idl"><a data-link-type="idl">closing</a></code> flag switches to true or the worker stops
being a suspendable worker.</p>
    <li data-md>
     <p>Jump to the script’s code entry-point, and let that run until it either
returns, fails to catch an exception, or gets prematurely aborted by the
"kill a worker" or "terminate a worker" algorithms defined below.</p>
    <li data-md>
     <p>If <em>worker global scope</em> is actually a <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope⑦">DedicatedWorkerGlobalScope</a></code> object
 (i.e. the worker is a dedicated worker), then enable the port message
 queue of the worker’s implicit port.</p>
    <li data-md>
     <p>Event loop: Run the responsible event loop specified by settings object
 until it is destroyed.</p>
     <p class="note" role="note"> The handling of events or the execution of callbacks by tasks run by the
 event loop might get prematurely aborted by the "kill a worker" or
 "terminate a worker" algorithms defined below. </p>
     <p>The worker processing model remains on this step until the event loop
 is destroyed, which happens after the <code class="idl"><a data-link-type="idl">closing</a></code> flag is set to true, as
 described in the event loop processing model.</p>
     <p></p>
    <li data-md>
     <p>Empty the <em>worker global scope</em>’s list of active timers.</p>
    <li data-md>
     <p>Disentangle all the ports in the list of the worker’s ports.</p>
    <li data-md>
     <p>Empty the worker’s list of the worker’s Documents.</p>
   </ol>
   <p>When a user agent is to <dfn data-dfn-type="dfn" data-noexport id="terminate-a-worker">terminate a worker<a class="self-link" href="#terminate-a-worker"></a></dfn> it must run the
following steps in parallel with the worker’s main loop (the "run a worker"
processing model defined above):</p>
   <ol>
    <li data-md>
     <p>Set the worker’s <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①⑧">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl">closing</a></code> flag to true.</p>
    <li data-md>
     <p>If there are any tasks queued in the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①①⑨">WorkerGlobalScope</a></code> object’s event
loop’s task queues, discard them without processing them.</p>
    <li data-md>
     <p>Wait a user-agent-defined amount of time.</p>
    <li data-md>
     <p>Abort the script currently running in the worker.</p>
    <li data-md>
     <p>If the worker’s <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②⓪">WorkerGlobalScope</a></code> object is actually a <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope⑧">DedicatedWorkerGlobalScope</a></code> object (i.e. the worker is a dedicated
worker), then empty the <code class="idl"><a data-link-type="idl">port message queue</a></code> of the port that the
worker’s implicit port is entangled with.</p>
   </ol>
   <p>User agents may invoke the "terminate a worker" processing model on a worker at
any time, e.g. in response to user requests, in response to CPU quota
management, or when a worker stops being an active needed worker and the
worker continues executing even after its <code class="idl"><a data-link-type="idl">closing</a></code> flag was set to true.</p>
   <p>When a user agent is to terminate a worker it must run the following steps in
parallel with the worker’s main loop (the "run a worker" processing model
defined above):</p>
   <ol>
    <li data-md>
     <p>Set the worker’s <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②①">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl">closing</a></code> flag to true.</p>
    <li data-md>
     <p>If there are any tasks queued in the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②②">WorkerGlobalScope</a></code> object’s event
loop’s task queues, discard them without processing them.</p>
    <li data-md>
     <p>Abort the script currently running in the worker.</p>
    <li data-md>
     <p>If the worker’s <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②③">WorkerGlobalScope</a></code> object is actually a <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope⑨">DedicatedWorkerGlobalScope</a></code> object (i.e. the worker is a dedicated
worker), then empty the port message queue of the port that the worker’s
implicit port is entangled with.</p>
   </ol>
   <p>The task source for the tasks mentioned above is the DOM manipulation task
source.</p>
   <h3 class="heading settled" data-level="3.5" id="runtime-script-errors"><span class="secno">3.5. </span><span class="content">Runtime script errors</span><a class="self-link" href="#runtime-script-errors"></a></h3>
   <p>Whenever an uncaught runtime script error occurs in one of the worker’s
scripts, if the error did not occur while handling a previous script error,
the user agent must report the error for that script, with the position (line
number and column number) where the error occurred, using the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②④">WorkerGlobalScope</a></code> object as the target. <a data-link-type="biblio" href="#biblio-html">[HTML]</a></p>
   <p>For shared workers, if the error is still not handled afterwards, the error
may be reported to the user. <a data-link-type="biblio" href="#biblio-html">[HTML]</a></p>
   <p>For dedicated workers, if the error is still not handled afterwards, the user
agent must queue a task to fire a trusted event that uses the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#errorevent" id="ref-for-errorevent">ErrorEvent</a></code> interface, with the name error, that doesn’t bubble and is cancelable, with
its message, filename, lineno, colno, attributes initialized appropriately,
and with the error attribute initialized to null, at the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①②">Worker</a></code> object
associated with the worker. If the event is not canceled, the user agent must
act as if the uncaught runtime script error had occurred in the global scope
that the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①③">Worker</a></code> object is in, thus repeating the entire runtime script
error reporting process one level up.</p>
   <p>If the implicit port connecting the worker to its <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①④">Worker</a></code> object has been
disentangled (i.e. if the parent worker has been terminated), then the user
agent must act as if the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①⑤">Worker</a></code> object had no <code>error</code> event
handler and as if that worker’s onerror attribute was null, but must otherwise
act as described above.</p>
   <p class="note" role="note"> Thus, error reports propagate up to the chain of dedicated workers up to the
original <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑤">Document</a></code>, even if some of the workers along this chain have been
terminated and garbage collected. </p>
   <p>The task source for the task mentioned above is the DOM manipulation task
source.</p>
   <h3 class="heading settled" data-level="3.6" id="creating-workers"><span class="secno">3.6. </span><span class="content">Creating workers</span><a class="self-link" href="#creating-workers"></a></h3>
   <h4 class="heading settled" data-level="3.6.1" id="abstract-worker-interface"><span class="secno">3.6.1. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#abstractworker" id="ref-for-abstractworker">AbstractWorker</a></code> abstract interface</span><a class="self-link" href="#abstract-worker-interface"></a></h4>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObject"><c- g>NoInterfaceObject</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=<c- n>Window</c->,<a class="idl-code" data-link-type="extended-attribute"><c- g>Worker</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="abstractworker"><code><c- g>AbstractWorker</c-></code></dfn> {
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑧"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-abstractworker-onerror" id="ref-for-handler-abstractworker-onerror"><c- g>onerror</c-></a>;
};
</pre>
   <p>The following are the event handlers (and their corresponding event handler
event types) that must be supported, as event handler IDL attributes, by
objects implementing the <code class="idl"><a data-link-type="idl" href="#abstractworker" id="ref-for-abstractworker①">AbstractWorker</a></code> interface:</p>
   <table>
    <thead>
     <tr>
      <th> <span title="event handlers">Event handler</span> 
      <th> <span>Event handler event type</span> 
    <tbody>
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="AbstractWorker" data-dfn-type="attribute" data-export data-lt="onerror" id="handler-abstractworker-onerror" title="handler-AbstractWorker-onerror"> <code>onerror</code> </dfn> 
      <td> <code title="event-error">error</code> 
   </table>
   <h4 class="heading settled" data-level="3.6.2" id="script-settings"><span class="secno">3.6.2. </span><span class="content">Script settings for workers</span><a class="self-link" href="#script-settings"></a></h4>
   <p>When the user agent is required to set up a worker script settings object,
given a <em>worker global scope</em> and a URL script address, it must run the
following steps:</p>
   <ol>
    <li data-md>
     <p>Let <em>inherited responsible browsing context</em>be the responsible browsing
context specified by the incumbent settings object.</p>
    <li data-md>
     <p>Let <em>inherited responsible document</em> be the responsible document specified
by the incumbent settings object.</p>
    <li data-md>
     <p>Let inherited origin be the origin specified by the incumbent settings
object.</p>
    <li data-md>
     <p>Let <em>worker event loop</em> be a newly created event loop.</p>
    <li data-md>
     <p>Let settings object be a new script settings object whose algorithms are
defined as follows:</p>
     <dl>
      <dt data-md>The script execution environments
      <dd data-md>
       <p>When the script settings object is created, for each language supported by the user agent, create an appropriate execution environment as defined by the relevant specification.</p>
      <dd data-md>
       <p>When a script execution environment is needed, return the appropriate one from those created when the script settings object was created.</p>
      <dd data-md>
       <p class="note" role="note">Currently, workers only support JavaScript, so only a JavaScript execution environment is actually needed here.</p>
      <dt data-md>The global object
      <dd data-md>
       <p>Return <em>worker global scope</em>.</p>
      <dt data-md>The responsible browsing context
      <dd data-md>
       <p>Return <em>inherited responsible browsing context</em>.</p>
      <dt data-md>The responsible document
      <dd data-md>
       <p>Return <em>inherited responsible document</em>.</p>
      <dt data-md>The responsible event loop
      <dd data-md>
       <p>Return <em>worker event loop</em>.</p>
      <dt data-md>The API referrer source
      <dd data-md>
       <p>Return <em>script address</em>.</p>
      <dt data-md>The API URL character encoding
      <dd data-md>
       <p>Return UTF-8.</p>
      <dt data-md>The API base URL
      <dd data-md>
       <p>Return <em>worker URL</em>.</p>
      <dt data-md>The origin and effective script origin
      <dd data-md>
       <p>Return <em>inherited origin</em>.</p>
     </dl>
    <li data-md>
     <p>Return <em>settings</em> object.</p>
   </ol>
   <h4 class="heading settled" data-level="3.6.3" id="dedicated-workers-and-worker-interface"><span class="secno">3.6.3. </span><span class="content">Dedicated workers and the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①⑥">Worker</a></code> interface</span><a class="self-link" href="#dedicated-workers-and-worker-interface"></a></h4>
<pre class="idl highlight def">[<dfn class="dfn-paneled idl-code" data-dfn-for="Worker" data-dfn-type="constructor" data-export data-lt="Worker(scriptURL)" id="dom-worker-worker"><code><c- g>Constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Worker/Worker(scriptURL)" data-dfn-type="argument" data-export id="dom-worker-worker-scripturl-scripturl"><code><c- g>scriptURL</c-></code></dfn>), <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=<c- n>Window</c->,<a class="idl-code" data-link-type="extended-attribute"><c- g>Worker</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="worker"><code><c- g>Worker</c-></code></dfn> : <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①"><c- n>EventTarget</c-></a> {
  <c- b>void</c-> <dfn class="dfn-paneled idl-code" data-dfn-for="Worker" data-dfn-type="method" data-export data-lt="terminate()" id="dom-worker-terminate"><code><c- g>terminate</c-></code></dfn>();

  <c- b>void</c-> <dfn class="idl-code" data-dfn-for="Worker" data-dfn-type="method" data-export data-lt="postMessage(message, transfer)|postMessage(message)" id="dom-worker-postmessage"><code><c- g>postMessage</c-></code><a class="self-link" href="#dom-worker-postmessage"></a></dfn>(<c- b>any</c-> <dfn class="idl-code" data-dfn-for="Worker/postMessage(message, transfer), Worker/postMessage(message)" data-dfn-type="argument" data-export id="dom-worker-postmessage-message-transfer-message"><code><c- g>message</c-></code><a class="self-link" href="#dom-worker-postmessage-message-transfer-message"></a></dfn>, <c- b>optional</c-> <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name"><c- n>Transferable</c-></a>> <dfn class="idl-code" data-dfn-for="Worker/postMessage(message, transfer), Worker/postMessage(message)" data-dfn-type="argument" data-export id="dom-worker-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code><a class="self-link" href="#dom-worker-postmessage-message-transfer-transfer"></a></dfn>);
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑨"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-worker-onmessage" id="ref-for-handler-worker-onmessage"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①⓪"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-worker-onmessageerror" id="ref-for-handler-worker-onmessageerror"><c- g>onmessageerror</c-></a>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-workeroptions"><code><c- g>WorkerOptions</c-></code></dfn> {
  <a class="n" data-link-type="idl-name" href="#enumdef-workertype" id="ref-for-enumdef-workertype"><c- n>WorkerType</c-></a> <dfn class="idl-code" data-default="&quot;classic&quot;" data-dfn-for="WorkerOptions" data-dfn-type="dict-member" data-export data-type="WorkerType " id="dom-workeroptions-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-workeroptions-type"></a></dfn> = "classic";
  <a class="n" data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestcredentials" id="ref-for-requestcredentials"><c- n>RequestCredentials</c-></a> <dfn class="idl-code" data-default="&quot;omit&quot;" data-dfn-for="WorkerOptions" data-dfn-type="dict-member" data-export data-type="RequestCredentials " id="dom-workeroptions-credentials"><code><c- g>credentials</c-></code><a class="self-link" href="#dom-workeroptions-credentials"></a></dfn> = "omit"; // Only used if type is "module"
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-default="&quot;&quot;" data-dfn-for="WorkerOptions" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-workeroptions-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-workeroptions-name"></a></dfn> = "";
};

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-workertype"><code><c- g>WorkerType</c-></code></dfn> { <dfn class="idl-code" data-dfn-for="WorkerType" data-dfn-type="enum-value" data-export id="dom-workertype-classic"><code><c- s>"classic"</c-></code><a class="self-link" href="#dom-workertype-classic"></a></dfn>, <dfn class="idl-code" data-dfn-for="WorkerType" data-dfn-type="enum-value" data-export id="dom-workertype-module"><code><c- s>"module"</c-></code><a class="self-link" href="#dom-workertype-module"></a></dfn> };

<a class="n" data-link-type="idl-name" href="#worker" id="ref-for-worker①⑦"><c- n>Worker</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="#abstractworker" id="ref-for-abstractworker②"><c- n>AbstractWorker</c-></a> ;
</pre>
   <dl class="note">
    <dt><var>worker</var>" = new "<code>Worker</code>"("<var>scriptURL</var>" [, "<var>options</var>" ])"
    <dd> Returns a new <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①⑧">Worker</a></code> object. scriptURL will be fetched and executed in
    the background, creating a new global environment for which worker
    represents the communication channel. options can be used to define the <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name⑤">name</a></code> of that global environment via the <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name⑥">name</a></code> option, primarily for
    debugging purposes. It can also ensure this new global environment
    supports JavaScript modules (specify type: "module"), and if that is
    specified, can also be used to specify how scriptURL is fetched
    through the credentials option. 
    <dt><var>worker</var> . <code>terminate()</code>
    <dd> Aborts worker’s associated global environment. 
    <dt><var>worker</var> . <code>postMessage(message [, transfer])</code>
    <dd> Clones message and transmits it to worker’s global environment. transfer can
    be passed as a list of objects that are to be transferred rather than cloned. 
   </dl>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-worker-terminate" id="ref-for-dom-worker-terminate">terminate()</a></code> method, when invoked, must cause the "terminate a worker"
algorithm to be run on the worker with which the object is associated.</p>
   <p><code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker①⑨">Worker</a></code> objects act as if they had an implicit <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑦">MessagePort</a></code> associated with them. This port is part of a channel that is set up when the
worker is created, but it is not exposed. This object must never be garbage
collected before the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker②⓪">Worker</a></code> object.</p>
   <p>All messages received by that port must immediately be retargeted at the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker②①">Worker</a></code> object.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-postmessage" id="ref-for-dom-dedicatedworkerglobalscope-postmessage③">postMessage()</a></code> method on <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker②②">Worker</a></code> objects must act as if, when
invoked, it <code class="idl"><a data-link-type="idl">immediately invoked the method of the same name</a></code> on the port,
with the same arguments, and returned the same return value.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-postmessage" id="ref-for-dom-dedicatedworkerglobalscope-postmessage④">postMessage()</a></code> method’s first argument can be structured data:</p>
<pre class="lang-js example highlight" id="example-02526d2f"><a class="self-link" href="#example-02526d2f"></a>worker<c- p>.</c->postMessage<c- p>({</c->opcode<c- o>:</c-> <c- t>'activate'</c-><c- p>,</c-> device<c- o>:</c-> <c- mi>1938</c-><c- p>,</c-> parameters<c- o>:</c-> <c- p>[</c-><c- mi>23</c-><c- p>,</c-> <c- mi>102</c-><c- p>]});</c->
</pre>
   <p>The following are the event handlers (and their corresponding event handler
event types) that must be supported, as event handler IDL attributes, by
objects implementing the <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker②③">Worker</a></code> interface:</p>
   <table>
    <thead>
     <tr>
      <th> <span title="event handlers">Event handler</span> 
      <th> <span>Event handler event type</span> 
    <tbody>
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="Worker" data-dfn-type="attribute" data-export data-lt="onmessage" id="handler-worker-onmessage" title="handler-Worker-onmessage"> <code>onmessage</code> </dfn> 
      <td> <code title="event-message">message</code> 
     <tr>
      <td> <dfn class="dfn-paneled idl-code" data-dfn-for="Worker" data-dfn-type="attribute" data-export data-lt="onmessageerror" id="handler-worker-onmessageerror" title="handler-Worker-onmessageerror"> <code>onmessageerror</code> </dfn> 
      <td> <code title="event-messageerror">messageerror</code> 
   </table>
   <p>When the <code class="idl"><a data-link-type="idl" href="#dom-worker-worker" id="ref-for-dom-worker-worker①">Worker(scriptURL)</a></code> constructor is invoked, the user agent must run
the following steps:</p>
   <ol>
    <li data-md>
     <p>The user agent may throw a SecurityError exception and abort these steps
if the request violates a policy decision (e.g. if the user agent is
configured to not allow the page to start dedicated workers).</p>
    <li data-md>
     <p>Resolve the scriptURL argument relative to the API base URL specified by
the entry settings object when the method was invoked.</p>
    <li data-md>
     <p>If this fails, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#syntaxerror" id="ref-for-syntaxerror">SyntaxError</a></code> exception and abort these steps.</p>
    <li data-md>
     <p>Let worker URL be the resulting absolute URL.</p>
    <li data-md>
     <p>If the scheme component of worker URL is not "data", and the origin of
worker URL is not the same as the origin specified by the incumbent
settings object, then throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror" id="ref-for-securityerror">SecurityError</a></code> exception and abort these
steps.</p>
     <p class="note" role="note"> For example, scripts can be external files with the same scheme, host,
and port as the original page, or data: URLs, or same-origin blob: URLs.
Thus, an https: page couldn’t start workers using scripts with http: URLs. <a data-link-type="biblio" href="#biblio-fileapi">[FILEAPI]</a>. </p>
    <li data-md>
     <p>Create a new <code class="idl"><a data-link-type="idl" href="#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope①⓪">DedicatedWorkerGlobalScope</a></code> object. Let <em>worker global scope</em> be this new object.</p>
    <li data-md>
     <p>Set up a worker script settings object with <em>worker global scope</em> and worker
URL, and let settings object be the result.</p>
    <li data-md>
     <p>Create a new <code class="idl"><a data-link-type="idl" href="#worker" id="ref-for-worker②④">Worker</a></code> object, associated with <em>worker global scope</em>. Let
worker be this new object.</p>
    <li data-md>
     <p>Create a new <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑧">MessagePort</a></code> object whose owner is the incumbent settings
object. Let this be the outside port.</p>
    <li data-md>
     <p>Associate the outside port with worker.</p>
    <li data-md>
     <p>Create a new <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport⑨">MessagePort</a></code> object whose owner is script settings. Let
 inside port be this new object.</p>
    <li data-md>
     <p>Associate inside port with <em>worker global scope</em>.</p>
    <li data-md>
     <p>Entangle outside port and inside port.</p>
    <li data-md>
     <p>Return worker, and run the following steps asynchronously.</p>
    <li data-md>
     <p>Enable outside port’s port message queue.</p>
    <li data-md>
     <p>Let docs be the list of relevant <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑥">Document</a></code> objects to add given the
 incumbent settings object.</p>
    <li data-md>
     <p>Add to <em>worker global scope</em>’s list of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑦">Document</a></code>s the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑧">Document</a></code> objects in docs.</p>
    <li data-md>
     <p>If the global object specified by the incumbent settings object is a <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②⑤">WorkerGlobalScope</a></code> object (i.e. we are creating a nested worker), add <em>worker global scope</em> to the list of the worker’s workers of the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②⑥">WorkerGlobalScope</a></code> object that is the global object specified by the
 incumbent settings object.</p>
    <li data-md>
     <p>Run a worker for the script with URL worker URL and the script settings
 object settings object.</p>
   </ol>
   <h4 class="heading settled" data-level="3.6.4" id="shared-workers-and-sharedworker-interface"><span class="secno">3.6.4. </span><span class="content">Shared workers and the <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker④">SharedWorker</a></code> interface</span><a class="self-link" href="#shared-workers-and-sharedworker-interface"></a></h4>
<pre class="idl highlight def">[<dfn class="dfn-paneled idl-code" data-dfn-for="SharedWorker" data-dfn-type="constructor" data-export data-lt="SharedWorker(scriptURL, options)|SharedWorker(scriptURL)" id="dom-sharedworker-sharedworker"><code><c- g>Constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="SharedWorker/SharedWorker(scriptURL, options)" data-dfn-type="argument" data-export id="dom-sharedworker-sharedworker-scripturl-options-scripturl"><code><c- g>scriptURL</c-></code><a class="self-link" href="#dom-sharedworker-sharedworker-scripturl-options-scripturl"></a></dfn>, <c- b>optional</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#dictdef-workeroptions" id="ref-for-dictdef-workeroptions"><c- n>WorkerOptions</c-></a>) <dfn class="idl-code" data-dfn-for="SharedWorker/SharedWorker(scriptURL, options)" data-dfn-type="argument" data-export id="dom-sharedworker-sharedworker-scripturl-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sharedworker-sharedworker-scripturl-options-options"></a></dfn>), <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=<c- n>Window</c->,<a class="idl-code" data-link-type="extended-attribute"><c- g>Worker</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sharedworker"><code><c- g>SharedWorker</c-></code></dfn> : <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget②"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①⓪"><c- n>MessagePort</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SharedWorker" data-dfn-type="attribute" data-export data-readonly data-type="MessagePort" id="dom-sharedworker-port"><code><c- g>port</c-></code></dfn>;
};
<a class="n" data-link-type="idl-name" href="#sharedworker" id="ref-for-sharedworker⑤"><c- n>SharedWorker</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="#abstractworker" id="ref-for-abstractworker③"><c- n>AbstractWorker</c-></a> ;
</pre>
   <dl class="note">
    <dt><var>sharedWorker</var>" = new "<code>SharedWorker</code>"("<var>scriptURL</var>" [, "<var>name</var>" ])"
    <dd> Returns a new <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker⑥">SharedWorker</a></code> object. scriptURL will be fetched and
    executed in the background, creating a new global environment for which
    sharedWorker represents the communication channel. <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name⑦">name</a></code> can be used to
    define the name of that global environment. 
    <dt><var>sharedWorker</var>" = new "<code>SharedWorker</code>"("<var>scriptURL</var>" [, "<var>options</var>" ])"
    <dd> Returns a new <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker⑦">SharedWorker</a></code> object. scriptURL will be fetched and
    executed in the background, creating a new global environment for which
    sharedWorker represents the communication channel. options can be used
    to define the <code class="idl"><a data-link-type="idl" href="#dom-dedicatedworkerglobalscope-name" id="ref-for-dom-dedicatedworkerglobalscope-name⑧">name</a></code> of that global environment via the name option. It
    can also ensure this new global environment supports JavaScript modules
    (specify type: "module"), and if that is specified, can also be used to
    specify how scriptURL is fetched through the credentials option. 
    <dt><var>sharedWorker</var> . <code>port</code>
    <dd> Returns sharedWorker’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①①">MessagePort</a></code> object which can be used to
    communicate with the global environment. 
   </dl>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-port" id="ref-for-dom-sharedworker-port①">port</a></code> attribute must return the value it was assigned by the object’s
constructor. It represents the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①②">MessagePort</a></code> for communicating with the
shared worker.</p>
   <p>When the <code class="idl"><a data-link-type="idl">SharedWorker(scriptURL, name)</a></code> constructor is invoked, the user
agent must run the following steps:</p>
   <ol>
    <li data-md>
     <p>The user agent may throw a SecurityError exception and abort these steps
if the request violates a policy decision (e.g. if the user agent is
configured to not allow the page to start shared workers).</p>
    <li data-md>
     <p>Resolve the <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl">scriptURL</a></code> argument.</p>
    <li data-md>
     <p>If this fails, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#syntaxerror" id="ref-for-syntaxerror①">SyntaxError</a></code> exception and abort these steps.</p>
    <li data-md>
     <p>Let scriptURL be the resulting absolute URL and parsed <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl①">scriptURL</a></code> be the
resulting parsed URL.</p>
    <li data-md>
     <p>Let name be the value of the second argument, or the empty string if the
second argument was omitted.</p>
    <li data-md>
     <p>If the scheme component of parsed <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl②">scriptURL</a></code> is not "data", and the
origin of scriptURL is not the same as the origin specified by the
incumbent settings object, then throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror" id="ref-for-securityerror①">SecurityError</a></code> exception and
abort these steps.</p>
     <p class="note" role="note"> Thus, scripts must either be external files with the same scheme, host,
and port as the original page, or data: URLs. For example, an https: page
couldn’t start workers using scripts with http: URLs. </p>
    <li data-md>
     <p>Let docs be the list of relevant <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑨">Document</a></code> objects to add given the
incumbent settings object.</p>
    <li data-md>
     <p>Execute the following substeps atomically:</p>
     <ol>
      <li> Create a new <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker⑧">SharedWorker</a></code> object, which will shortly be associated with
a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①⓪">SharedWorkerGlobalScope</a></code> object. Let this <code class="idl"><a data-link-type="idl" href="#sharedworker" id="ref-for-sharedworker⑨">SharedWorker</a></code> object be
worker. 
      <li> Create a new <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①③">MessagePort</a></code> object whose owner is the incumbent settings
object. Let this be the outside port. 
      <li> Assign outside port to the port attribute of worker. 
      <li> Let <em>worker global scope</em> be null. 
      <li>
        If name is not the empty string and there exists a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①①">SharedWorkerGlobalScope</a></code> object whose <code class="idl"><a data-link-type="idl">closing</a></code> flag is false, whose
name attribute is exactly equal to name, and that is the global object
specified by a script settings object that specifies as its origin the same
origin as the origin of <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl③">scriptURL</a></code>, then let <em>worker global scope</em> be that <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①②">SharedWorkerGlobalScope</a></code> object. 
       <p>Otherwise, if name is the empty string and there exists a <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①③">SharedWorkerGlobalScope</a></code> object whose <code class="idl"><a data-link-type="idl">closing</a></code> flag is false, whose
name attribute is the empty string, and whose location attribute represents
an absolute URL that is exactly equal to <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl④">scriptURL</a></code>, then let worker
global scope be that <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①④">SharedWorkerGlobalScope</a></code> object.</p>
      <li>
        If <em>worker global scope</em> is not null, but the user agent has been configured
to disallow communication between the worker represented by the worker
global scope and the scripts whose settings objects are the incumbent
settings object, then set <em>worker global scope</em> to null. 
       <p class="note" role="note"> For example, a user agent could have a development mode that isolates a
particular top-level browsing context from all other pages, and scripts in
that development mode could be blocked from connecting to shared workers
running in the normal browser mode. </p>
      <li>
        If <em>worker global scope</em> is not null, then run these steps: 
       <ol>
        <li> If <em>worker global scope</em>’s location attribute represents an absolute
URL that is not exactly equal to <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl⑤">scriptURL</a></code>, then throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#urlmismatcherror" id="ref-for-urlmismatcherror">URLMismatchError</a></code> exception and abort all these steps. 
        <li> Associate worker with <em>worker global scope</em>. 
        <li> Let settings object be the script settings object whose global object
is <em>worker global scope</em>. 
        <li> Create a new <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①④">MessagePort</a></code> object whose owner is settings object. Let
this be the inside port. 
        <li> Entangle outside port and inside port. 
        <li> Create a trusted event that uses the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#messageevent" id="ref-for-messageevent">MessageEvent</a></code> interface, with the
name connect, which does not bubble, is not cancelable, has no default
action, has a <code class="idl"><a data-link-type="idl">data</a></code> attribute whose value is initialized to the empty
string, has a ports attribute whose value is initialized to a read only
array containing only the newly created port, and has a source attribute
whose value is initialized to the newly created port, and queue a task to
dispatch the event at <em>worker global scope</em>. 
        <li> Add to <em>worker global scope</em>’s list of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②⓪">Document</a></code>s  the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②①">Document</a></code> objects in docs. 
        <li> If the global object specified by the incumbent settings object is a <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②⑦">WorkerGlobalScope</a></code> object, add <em>worker global scope</em> to the list of the
worker’s workers of the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②⑧">WorkerGlobalScope</a></code> object that is the global
object specified by the incumbent settings object. 
        <li> Return worker and abort all these steps. 
       </ol>
      <li> Create a new <code class="idl"><a data-link-type="idl" href="#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope①⑤">SharedWorkerGlobalScope</a></code> object. Let <em>worker global scope</em> be
this new object. 
      <li> Set up a worker script settings object with <em>worker global scope</em> and <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl⑥">scriptURL</a></code>, and let settings object be the result. 
      <li> Associate worker with <em>worker global scope</em>. 
      <li> Set the name attribute of <em>worker global scope</em> to name. 
      <li> Create a new <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①⑤">MessagePort</a></code> object whose owner is settings object. Let
inside port be this new object. 
      <li> Entangle outside port and inside port. 
      <li data-md>
       <p>Return worker and perform the remaining steps asynchronously.</p>
      <li data-md>
       <p>Create a trusted event that uses the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#messageevent" id="ref-for-messageevent①">MessageEvent</a></code> interface, with the
 name connect, which does not bubble, is not cancelable, has no default
 action, has a <code class="idl"><a data-link-type="idl">data</a></code> attribute whose value is initialized to the empty
 string, has a ports attribute whose value is initialized to a read only
 array containing only the newly created port, and has a source attribute
 whose value is initialized to the newly created port, and queue a task to
 dispatch the event at <em>worker global scope</em>.</p>
      <li data-md>
       <p>Add to <em>worker global scope</em>’s list of the worker’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②②">Document</a></code>s the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②③">Document</a></code> objects in docs.</p>
      <li data-md>
       <p>If the global object specified by the incumbent settings object is a <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①②⑨">WorkerGlobalScope</a></code> object, add <em>worker global scope</em> to the list of the
 worker’s workers of the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③⓪">WorkerGlobalScope</a></code> object that is the global
 object specified by the incumbent settings object.</p>
      <li data-md>
       <p>Run a worker for the script with URL <code class="idl"><a data-link-type="idl" href="#dom-worker-worker-scripturl-scripturl" id="ref-for-dom-worker-worker-scripturl-scripturl⑦">scriptURL</a></code> and the script settings
 object settings object.</p>
     </ol>
     <p>The task source for the tasks mentioned above is the DOM manipulation task
source.</p>
     <h3 class="heading settled" data-level="3.7" id="concurrency"><span class="secno">3.7. </span><span class="content">Concurrent hardware capabilities</span><a class="self-link" href="#concurrency"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObject①"><c- g>NoInterfaceObject</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="navigatorconcurrenthardware"><code><c- g>NavigatorConcurrentHardware</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="NavigatorConcurrentHardware" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long long" id="dom-navigatorconcurrenthardware-hardwareconcurrency"><code><c- g>hardwareConcurrency</c-></code><a class="self-link" href="#dom-navigatorconcurrenthardware-hardwareconcurrency"></a></dfn>;
};
</pre>
     <dl class="note">
      <dt><var>self</var> . <code>navigator</code> . <code>hardwareConcurrency</code>
      <dd> Returns the number of logical processors potentially available to the user agent. 
     </dl>
     <p>The <code class="idl"><a data-link-type="idl">navigator.hardwareConcurrency</a></code> attribute’s getter must return a number
between 1 and the number of logical processors potentially available to the
user agent. If this cannot be determined, the getter must return 1.</p>
     <p>User agents should err toward exposing the number of logical processors
available, using lower values only in cases where there are user-agent
specific limits in place (such as a limitation on the number of workers
that can be created) or when the user agent desires to limit fingerprinting
possibilities.</p>
     <h3 class="heading settled" data-level="3.8" id="importing"><span class="secno">3.8. </span><span class="content">Importing scripts and libraries</span><a class="self-link" href="#importing"></a></h3>
     <p>When a script invokes the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#dom-workerglobalscope-importscripts" id="ref-for-dom-workerglobalscope-importscripts">importScripts(urls)</a></code> method on a <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③①">WorkerGlobalScope</a></code> object, the user agent must run the following steps:</p>
     <ol>
      <li data-md>
       <p>If there are no arguments, return without doing anything. Abort these steps.</p>
      <li data-md>
       <p>Let settings object be the incumbent settings object.</p>
      <li data-md>
       <p>Resolve each argument.</p>
      <li data-md>
       <p>If any fail, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#syntaxerror" id="ref-for-syntaxerror②">SyntaxError</a></code> exception and abort these steps.</p>
      <li data-md>
       <p>Attempt to fetch each resource identified by the resulting absolute URLs,
from the origin specified by settings object, using the API referrer source
specified by settings object, and with the synchronous flag set.</p>
      <li data-md>
       <p>For each argument in turn, in the order given, starting with the first one,
run these substeps:</p>
       <ol>
        <li>
          Wait for the fetching attempt for the corresponding resource to complete. 
         <p>If the fetching attempt failed, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#networkerror" id="ref-for-networkerror">NetworkError</a></code> exception and
abort all these steps.</p>
         <p>If the attempt succeeds, then let source be the result of running the
UTF-8 decode algorithm on the script resource.</p>
         <p>Let language be JavaScript.</p>
         <p class="note" role="note"> As with the worker’s script, the script here is always assumed to be
JavaScript, regardless of the MIME type. </p>
        <li>
          Create a script using source as the script source, the URL from which
source was obtained, language as the scripting language, and settings
object as the script settings object. 
         <p>If the script came from a resource whose URL does not have the same origin
as the origin specified by the incumbent settings object, then pass the
muted errors flag to the create a script algorithm as well.</p>
         <p>Let the newly created script run until it either returns, fails to parse,
fails to catch an exception, or gets prematurely aborted by the "kill a
worker" or "terminate a worker" algorithms defined above.</p>
         <p>If it failed to parse, then throw an ECMAScript SyntaxError exception and
abort all these steps. <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a></p>
         <p>If an exception was thrown or if the script was prematurely aborted, then
abort all these steps, letting the exception or aborting continue to be
processed by the calling script.</p>
       </ol>
     </ol>
     <p>If the "kill a worker" or "terminate a worker" algorithms abort the script
then abort all these steps.</p>
     <h3 class="heading settled" data-level="3.9" id="workernavigator-object"><span class="secno">3.9. </span><span class="content">The WorkerNavigator object</span><a class="self-link" href="#workernavigator-object"></a></h3>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerglobalscope-navigator" id="ref-for-dom-workerglobalscope-navigator">navigator</a></code> attribute of the <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③②">WorkerGlobalScope</a></code> interface must
return an instance of the <code class="idl"><a data-link-type="idl" href="#workernavigator" id="ref-for-workernavigator①">WorkerNavigator</a></code> interface, which represents the
identity and state of the user agent (the client):</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦"><c- g>Exposed</c-></a>=<c- n>Worker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="workernavigator"><code><c- g>WorkerNavigator</c-></code></dfn> {};
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator②"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/system-state.html#navigatorid" id="ref-for-navigatorid"><c- n>NavigatorID</c-></a>;
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator③"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/system-state.html#navigatorlanguage" id="ref-for-navigatorlanguage"><c- n>NavigatorLanguage</c-></a>;
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator④"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/offline.html#navigatoronline" id="ref-for-navigatoronline"><c- n>NavigatorOnLine</c-></a>;
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator⑤"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="#navigatorconcurrenthardware" id="ref-for-navigatorconcurrenthardware"><c- n>NavigatorConcurrentHardware</c-></a>;
</pre>
     <h3 class="heading settled" data-level="3.10" id="worker-locations"><span class="secno">3.10. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#workerlocation" id="ref-for-workerlocation②">WorkerLocation</a></code> interface</span><a class="self-link" href="#worker-locations"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧"><c- g>Exposed</c-></a>=<c- n>Worker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="workerlocation"><code><c- g>WorkerLocation</c-></code></dfn> {
  <dfn data-dfn-for="WorkerLocation" data-dfn-type="dfn" data-export data-lt="stringification behavior" id="WorkerLocation-stringification-behavior"><c- b>stringifier</c-><a class="self-link" href="#WorkerLocation-stringification-behavior"></a></dfn> <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-href"><code><c- g>href</c-></code><a class="self-link" href="#dom-workerlocation-href"></a></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-origin"><code><c- g>origin</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString④"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-protocol"><code><c- g>protocol</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-host"><code><c- g>host</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑥"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-hostname"><code><c- g>hostname</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑦"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-port"><code><c- g>port</c-></code><a class="self-link" href="#dom-workerlocation-port"></a></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑧"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-pathname"><code><c- g>pathname</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑨"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-search"><code><c- g>search</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①⓪"><c- b>USVString</c-></a> <dfn class="idl-code" data-dfn-for="WorkerLocation" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-workerlocation-hash"><code><c- g>hash</c-></code><a class="self-link" href="#dom-workerlocation-hash"></a></dfn>;
};
</pre>
     <p>A <code class="idl"><a data-link-type="idl" href="#workerlocation" id="ref-for-workerlocation③">WorkerLocation</a></code> object has an associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③③">WorkerGlobalScope</a></code> object
(a <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③④">WorkerGlobalScope</a></code> object).</p>
     <p>The <code class="idl"><a data-link-type="idl">href</a></code> attribute’s getter must return the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③⑤">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url">url</a></code>, <code class="idl"><a data-link-type="idl">serialized</a></code>.</p>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-origin" id="ref-for-dom-workerlocation-origin①">origin</a></code> attribute’s getter must return the serialization of the
associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③⑥">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url①">url</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-origin" id="ref-for-dom-workerlocation-origin②">origin</a></code>.</p>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-protocol" id="ref-for-dom-workerlocation-protocol">protocol</a></code> attribute’s getter must run return the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③⑦">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url②">url</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-meta-scheme" id="ref-for-dom-meta-scheme">scheme</a></code>, followed by ":".</p>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-host" id="ref-for-dom-workerlocation-host">host</a></code> attribute’s getter must run these steps:</p>
     <ol>
      <li data-md>
       <p>Let url be the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③⑧">WorkerGlobalScope</a></code> object’s url.</p>
      <li data-md>
       <p>If url’s <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-host" id="ref-for-dom-workerlocation-host①">host</a></code> is null, return the empty string.</p>
      <li data-md>
       <p>If url’s <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-port" id="ref-for-dom-sharedworker-port②">port</a></code> is null, return url’s <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-host" id="ref-for-dom-workerlocation-host②">host</a></code>, <code class="idl"><a data-link-type="idl">serialized</a></code>.</p>
      <li data-md>
       <p>Return url’s <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-host" id="ref-for-dom-workerlocation-host③">host</a></code>, <code class="idl"><a data-link-type="idl">serialized</a></code>, followed by ":" and url’s <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-port" id="ref-for-dom-sharedworker-port③">port</a></code>, <code class="idl"><a data-link-type="idl">serialized</a></code>.</p>
     </ol>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-hostname" id="ref-for-dom-workerlocation-hostname">hostname</a></code> attribute’s getter must run these steps:</p>
     <ol>
      <li data-md>
       <p>Let host be the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①③⑨">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url③">url</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-host" id="ref-for-dom-workerlocation-host④">host</a></code>.</p>
      <li data-md>
       <p>If host is null, return the empty string.</p>
      <li data-md>
       <p>Return host, <code class="idl"><a data-link-type="idl">serialized</a></code>.</p>
     </ol>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-port" id="ref-for-dom-sharedworker-port④">port</a></code> attribute’s getter must run these steps:</p>
     <ol>
      <li data-md>
       <p>Let port be the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①④⓪">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url④">url</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-sharedworker-port" id="ref-for-dom-sharedworker-port⑤">port</a></code>.</p>
      <li data-md>
       <p>If port is null, return the empty string.</p>
      <li data-md>
       <p>Return port, <code class="idl"><a data-link-type="idl">serialized</a></code>.</p>
     </ol>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-pathname" id="ref-for-dom-workerlocation-pathname">pathname</a></code> attribute’s getter must run these steps:</p>
     <ol>
      <li data-md>
       <p>Let url be the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①④①">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url⑤">url</a></code>.</p>
      <li data-md>
       <p>If url’s <code class="idl"><a data-link-type="idl">cannot-be-a-base-URL</a></code> flag is set, return the first string in url’s <code class="idl"><a data-link-type="idl">path</a></code>.</p>
      <li data-md>
       <p>Return "/", followed by the strings in url’s <code class="idl"><a data-link-type="idl">path</a></code> (including empty strings), separated from each other by "/".</p>
     </ol>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-workerlocation-search" id="ref-for-dom-workerlocation-search">search</a></code> attribute’s getter must run these steps:</p>
     <ol>
      <li data-md>
       <p>Let query be the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①④②">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url⑥">url</a></code>'s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/IndexedDB/#dom-idbobjectstore-count-query-query" id="ref-for-dom-idbobjectstore-count-query-query">query</a></code>.</p>
      <li data-md>
       <p>If query is either null or the empty string, return the empty string.</p>
      <li data-md>
       <p>Return "?", followed by query.</p>
     </ol>
     <p>The hash attribute’s getter must run these steps:</p>
     <ol>
      <li data-md>
       <p>Let fragment be the associated <code class="idl"><a data-link-type="idl" href="#workerglobalscope①" id="ref-for-workerglobalscope①④③">WorkerGlobalScope</a></code> object’s <code class="idl"><a data-link-type="idl" href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url" id="ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url⑦">url</a></code>'s <code class="idl"><a data-link-type="idl">fragment</a></code>.</p>
      <li data-md>
       <p>If fragment is either null or the empty string, return the empty string.</p>
      <li data-md>
       <p>Return "#", followed by fragment.</p>
     </ol>
     <h3 class="heading settled" data-level="3.11" id="security-considerations"><span class="secno">3.11. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h3>
     <p>There are no known security implications directly related to this standard as
of today.</p>
     <h3 class="heading settled" data-level="3.12" id="privacy-considerations"><span class="secno">3.12. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h3>
     <p>The <code class="idl"><a data-link-type="idl" href="#navigatorconcurrenthardware" id="ref-for-navigatorconcurrenthardware①">NavigatorConcurrentHardware</a></code> mechanism can be used to fingerprint
users. User agents may choose to provide a mechanism to not disclose this
information by having the getter return 1.</p>
     <p>Additionally, user agents may choose to disclose this information in private
browsing mode by having the getter return 1.</p>
     <section>
      <h2 class="no-num heading settled" id="acknowledgements"><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
       For inestimable work, and the drive to keep HTML up to date, particular
  thanks are due to Ian Hickson, and the other editors of the WHATWG:
  Anne van Kesteren, Domenic Denicola, Philip Jägenstedt, Simon Pieters. 
      <p>Thanks to Aaron Boodman, Алексей Проскуряков (Alexey Proskuryakov),
  Ben Turner, Dmitry Titov, Drew Wilson, Jeremy Orlow, Jonas Sicking,
  Justin James, Kevin Hakanson, Maciej Stachowiak, Michael Nordman,
  Mike Smith, and Philip Taylor for their useful and substantial comments.</p>
      <p>Huge thanks to the whole Gears team, who pioneered this technology and whose
  experience has been a huge influence on this specification.</p>
     </section>
   </ol>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
   <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
   <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="example-ae2b6bc0">
    <a class="self-link" href="#example-ae2b6bc0"></a> 
    <p>This is an example of an informative example.</p>
   </div>
   <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
   <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
  </div>
  <p id="back-to-top" role="navigation"><a href="#toc"><abbr title="Back to top">↑</abbr></a></p>
  . 
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#abstractworker">AbstractWorker</a><span>, in §3.6.1</span>
   <li><a href="#dom-sharedworkerglobalscope-applicationcache">applicationCache</a><span>, in §3.1.3</span>
   <li><a href="#dom-workertype-classic">"classic"</a><span>, in §3.6.3</span>
   <li><a href="#dom-workerglobalscope-close">close()</a><span>, in §3.1.1</span>
   <li><a href="#closing">closing</a><span>, in §3.2</span>
   <li><a href="#dom-workeroptions-credentials">credentials</a><span>, in §3.6.3</span>
   <li><a href="#dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a><span>, in §3.1.2</span>
   <li><a href="#dom-navigatorconcurrenthardware-hardwareconcurrency">hardwareConcurrency</a><span>, in §3.7</span>
   <li><a href="#dom-workerlocation-hash">hash</a><span>, in §3.10</span>
   <li><a href="#dom-workerlocation-host">host</a><span>, in §3.10</span>
   <li><a href="#dom-workerlocation-hostname">hostname</a><span>, in §3.10</span>
   <li><a href="#dom-workerlocation-href">href</a><span>, in §3.10</span>
   <li><a href="#dom-workerglobalscope-importscripts">importScripts()</a><span>, in §3.1.1</span>
   <li><a href="#dom-workerglobalscope-importscripts">importScripts(...urls)</a><span>, in §3.1.1</span>
   <li><a href="#dom-workerglobalscope-location">location</a><span>, in §3.1.1</span>
   <li><a href="#dom-workertype-module">"module"</a><span>, in §3.6.3</span>
   <li>
    name
    <ul>
     <li><a href="#dom-dedicatedworkerglobalscope-name">attribute for DedicatedWorkerGlobalScope</a><span>, in §3.1.2</span>
     <li><a href="#dom-sharedworkerglobalscope-name">attribute for SharedWorkerGlobalScope</a><span>, in §3.1.3</span>
     <li><a href="#dom-workeroptions-name">dict-member for WorkerOptions</a><span>, in §3.6.3</span>
    </ul>
   <li><a href="#dom-workerglobalscope-navigator">navigator</a><span>, in §3.1.1</span>
   <li><a href="#navigatorconcurrenthardware">NavigatorConcurrentHardware</a><span>, in §3.7</span>
   <li><a href="#handler-sharedworkerglobalscope-onconnect">onconnect</a><span>, in §3.1.3</span>
   <li>
    onerror
    <ul>
     <li><a href="#handler-abstractworker-onerror">attribute for AbstractWorker</a><span>, in §3.6.1</span>
     <li><a href="#handler-workerglobalscope-onerror">attribute for WorkerGlobalScope</a><span>, in §3.1.1</span>
    </ul>
   <li><a href="#handler-workerglobalscope-onlanguagechange">onlanguagechange</a><span>, in §3.1.1</span>
   <li>
    onmessage
    <ul>
     <li><a href="#handler-dedicatedworkerglobalscope-onmessage">attribute for DedicatedWorkerGlobalScope</a><span>, in §3.1.2</span>
     <li><a href="#handler-worker-onmessage">attribute for Worker</a><span>, in §3.6.3</span>
    </ul>
   <li>
    onmessageerror
    <ul>
     <li><a href="#handler-dedicatedworkerglobalscope-onmessageerror">attribute for DedicatedWorkerGlobalScope</a><span>, in §3.1.2</span>
     <li><a href="#handler-worker-onmessageerror">attribute for Worker</a><span>, in §3.6.3</span>
    </ul>
   <li><a href="#handler-workerglobalscope-onoffline">onoffline</a><span>, in §3.1.1</span>
   <li><a href="#handler-workerglobalscope-ononline">ononline</a><span>, in §3.1.1</span>
   <li><a href="#handler-workerglobalscope-onrejectionhandled">onrejectionhandled</a><span>, in §3.1.1</span>
   <li><a href="#handler-workerglobalscope-onunhandledrejection">onunhandledrejection</a><span>, in §3.1.1</span>
   <li><a href="#dom-workerlocation-origin">origin</a><span>, in §3.10</span>
   <li><a href="#dom-workerlocation-pathname">pathname</a><span>, in §3.10</span>
   <li>
    port
    <ul>
     <li><a href="#dom-sharedworker-port">attribute for SharedWorker</a><span>, in §3.6.4</span>
     <li><a href="#dom-workerlocation-port">attribute for WorkerLocation</a><span>, in §3.10</span>
    </ul>
   <li>
    postMessage(message)
    <ul>
     <li><a href="#dom-dedicatedworkerglobalscope-postmessage">method for DedicatedWorkerGlobalScope</a><span>, in §3.1.2</span>
     <li><a href="#dom-worker-postmessage">method for Worker</a><span>, in §3.6.3</span>
    </ul>
   <li>
    postMessage(message, transfer)
    <ul>
     <li><a href="#dom-dedicatedworkerglobalscope-postmessage">method for DedicatedWorkerGlobalScope</a><span>, in §3.1.2</span>
     <li><a href="#dom-worker-postmessage">method for Worker</a><span>, in §3.6.3</span>
    </ul>
   <li><a href="#dom-workerlocation-protocol">protocol</a><span>, in §3.10</span>
   <li><a href="#run-a-worker">run a worker</a><span>, in §3.4</span>
   <li><a href="#dom-workerlocation-search">search</a><span>, in §3.10</span>
   <li><a href="#dom-workerglobalscope-self">self</a><span>, in §3.1.1</span>
   <li><a href="#sharedworker">SharedWorker</a><span>, in §3.6.4</span>
   <li><a href="#sharedworkerglobalscope">SharedWorkerGlobalScope</a><span>, in §3.1.3</span>
   <li><a href="#dom-sharedworker-sharedworker">SharedWorker(scriptURL)</a><span>, in §3.6.4</span>
   <li><a href="#dom-sharedworker-sharedworker">SharedWorker(scriptURL, options)</a><span>, in §3.6.4</span>
   <li><a href="#WorkerLocation-stringification-behavior">stringification behavior</a><span>, in §3.10</span>
   <li><a href="#dom-worker-terminate">terminate()</a><span>, in §3.6.3</span>
   <li><a href="#terminate-a-worker">terminate a worker</a><span>, in §3.4</span>
   <li><a href="#the-official-moment-of-creation">the official moment of creation</a><span>, in §3.4</span>
   <li><a href="#dom-workeroptions-type">type</a><span>, in §3.6.3</span>
   <li><a href="#worker">Worker</a><span>, in §3.6.3</span>
   <li><a href="#workerglobalscope①">WorkerGlobalScope</a><span>, in §3.1.1</span>
   <li><a href="#workerlocation">WorkerLocation</a><span>, in §3.10</span>
   <li><a href="#workernavigator">WorkerNavigator</a><span>, in §3.9</span>
   <li><a href="#dictdef-workeroptions">WorkerOptions</a><span>, in §3.6.3</span>
   <li><a href="#dom-worker-worker">Worker(scriptURL)</a><span>, in §3.6.3</span>
   <li><a href="#enumdef-workertype">WorkerType</a><span>, in §3.6.3</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-document">
   <a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">3.3. The worker’s lifetime</a> <a href="#ref-for-document①">(2)</a> <a href="#ref-for-document②">(3)</a> <a href="#ref-for-document③">(4)</a> <a href="#ref-for-document④">(5)</a> <a href="#ref-for-document⑤">(6)</a> <a href="#ref-for-document⑥">(7)</a> <a href="#ref-for-document⑦">(8)</a> <a href="#ref-for-document⑧">(9)</a> <a href="#ref-for-document⑨">(10)</a> <a href="#ref-for-document①⓪">(11)</a> <a href="#ref-for-document①①">(12)</a> <a href="#ref-for-document①②">(13)</a> <a href="#ref-for-document①③">(14)</a> <a href="#ref-for-document①④">(15)</a>
    <li><a href="#ref-for-document①⑤">3.5. Runtime script errors</a>
    <li><a href="#ref-for-document①⑥">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-document①⑦">(2)</a> <a href="#ref-for-document①⑧">(3)</a>
    <li><a href="#ref-for-document①⑨">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-document②⓪">(2)</a> <a href="#ref-for-document②①">(3)</a> <a href="#ref-for-document②②">(4)</a> <a href="#ref-for-document②③">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventtarget">
   <a href="https://dom.spec.whatwg.org/#eventtarget">https://dom.spec.whatwg.org/#eventtarget</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventtarget">3.1.1. The WorkerGlobalScope common interface</a>
    <li><a href="#ref-for-eventtarget①">3.6.3. Dedicated workers and the Worker interface</a>
    <li><a href="#ref-for-eventtarget②">3.6.4. Shared workers and the SharedWorker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-eventtarget-addeventlistener">
   <a href="https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener">https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-eventtarget-addeventlistener">1.2.3. Shared workers introduction</a>
    <li><a href="#ref-for-dom-eventtarget-addeventlistener①">1.3.2. Communicating with a dedicated worker</a> <a href="#ref-for-dom-eventtarget-addeventlistener②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-requestcredentials">
   <a href="https://fetch.spec.whatwg.org/#requestcredentials">https://fetch.spec.whatwg.org/#requestcredentials</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-requestcredentials">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-applicationcache">
   <a href="https://html.spec.whatwg.org/multipage/offline.html#applicationcache">https://html.spec.whatwg.org/multipage/offline.html#applicationcache</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-applicationcache">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a> <a href="#ref-for-applicationcache①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-errorevent">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#errorevent">https://html.spec.whatwg.org/multipage/webappapis.html#errorevent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-errorevent">3.5. Runtime script errors</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventhandler">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventhandler">3.1.1. The WorkerGlobalScope common interface</a> <a href="#ref-for-eventhandler①">(2)</a> <a href="#ref-for-eventhandler②">(3)</a> <a href="#ref-for-eventhandler③">(4)</a> <a href="#ref-for-eventhandler④">(5)</a>
    <li><a href="#ref-for-eventhandler⑤">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a> <a href="#ref-for-eventhandler⑥">(2)</a>
    <li><a href="#ref-for-eventhandler⑦">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-eventhandler⑧">3.6.1. The AbstractWorker  abstract interface</a>
    <li><a href="#ref-for-eventhandler⑨">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-eventhandler①⓪">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-messageevent">
   <a href="https://html.spec.whatwg.org/multipage/comms.html#messageevent">https://html.spec.whatwg.org/multipage/comms.html#messageevent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-messageevent">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-messageevent①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-messageport">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport">https://html.spec.whatwg.org/multipage/web-messaging.html#messageport</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-messageport">1.3.2. Communicating with a dedicated worker</a> <a href="#ref-for-messageport①">(2)</a>
    <li><a href="#ref-for-messageport②">1.3.3. Shared workers</a>
    <li><a href="#ref-for-messageport③">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-messageport④">3.3. The worker’s lifetime</a> <a href="#ref-for-messageport⑤">(2)</a> <a href="#ref-for-messageport⑥">(3)</a>
    <li><a href="#ref-for-messageport⑦">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-messageport⑧">(2)</a> <a href="#ref-for-messageport⑨">(3)</a>
    <li><a href="#ref-for-messageport①⓪">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-messageport①①">(2)</a> <a href="#ref-for-messageport①②">(3)</a> <a href="#ref-for-messageport①③">(4)</a> <a href="#ref-for-messageport①④">(5)</a> <a href="#ref-for-messageport①⑤">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigatorid">
   <a href="https://html.spec.whatwg.org/multipage/system-state.html#navigatorid">https://html.spec.whatwg.org/multipage/system-state.html#navigatorid</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigatorid">3.9. The WorkerNavigator object</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigatorlanguage">
   <a href="https://html.spec.whatwg.org/multipage/system-state.html#navigatorlanguage">https://html.spec.whatwg.org/multipage/system-state.html#navigatorlanguage</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigatorlanguage">3.9. The WorkerNavigator object</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigatoronline">
   <a href="https://html.spec.whatwg.org/multipage/offline.html#navigatoronline">https://html.spec.whatwg.org/multipage/offline.html#navigatoronline</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigatoronline">3.9. The WorkerNavigator object</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-onerroreventhandler">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#onerroreventhandler">https://html.spec.whatwg.org/multipage/webappapis.html#onerroreventhandler</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-onerroreventhandler">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-workerglobalscope-connect">
   <a href="https://html.spec.whatwg.org/multipage/indices.html#event-workerglobalscope-connect">https://html.spec.whatwg.org/multipage/indices.html#event-workerglobalscope-connect</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-workerglobalscope-connect">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-workerglobalscope-importscripts">
   <a href="https://html.spec.whatwg.org/multipage/workers.html#dom-workerglobalscope-importscripts">https://html.spec.whatwg.org/multipage/workers.html#dom-workerglobalscope-importscripts</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerglobalscope-importscripts">3.8. Importing scripts and libraries</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-meta-scheme">
   <a href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-meta-scheme">https://html.spec.whatwg.org/multipage/obsolete.html#dom-meta-scheme</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-meta-scheme">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-messageport-start">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#dom-messageport-start">https://html.spec.whatwg.org/multipage/web-messaging.html#dom-messageport-start</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-messageport-start">1.3.2. Communicating with a dedicated worker</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-idbobjectstore-count-query-query">
   <a href="https://w3c.github.io/IndexedDB/#dom-idbobjectstore-count-query-query">https://w3c.github.io/IndexedDB/#dom-idbobjectstore-count-query-query</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-idbobjectstore-count-query-query">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-ArrayBuffer">
   <a href="https://heycam.github.io/webidl/#idl-ArrayBuffer">https://heycam.github.io/webidl/#idl-ArrayBuffer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-ArrayBuffer">1.3.2. Communicating with a dedicated worker</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://heycam.github.io/webidl/#idl-DOMString">https://heycam.github.io/webidl/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-idl-DOMString①">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-idl-DOMString②">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-idl-DOMString③">(2)</a>
    <li><a href="#ref-for-idl-DOMString④">3.6.4. Shared workers and the SharedWorker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">3.1.1. The WorkerGlobalScope common interface</a>
    <li><a href="#ref-for-Exposed①">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-Exposed②">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-Exposed③">3.6.1. The AbstractWorker  abstract interface</a>
    <li><a href="#ref-for-Exposed④">3.6.3. Dedicated workers and the Worker interface</a>
    <li><a href="#ref-for-Exposed⑤">3.6.4. Shared workers and the SharedWorker interface</a>
    <li><a href="#ref-for-Exposed⑥">3.7. Concurrent hardware capabilities</a>
    <li><a href="#ref-for-Exposed⑦">3.9. The WorkerNavigator object</a>
    <li><a href="#ref-for-Exposed⑧">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Global">
   <a href="https://heycam.github.io/webidl/#Global">https://heycam.github.io/webidl/#Global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Global">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-Global①">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-networkerror">
   <a href="https://heycam.github.io/webidl/#networkerror">https://heycam.github.io/webidl/#networkerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-networkerror">3.8. Importing scripts and libraries</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-NoInterfaceObject">
   <a href="https://heycam.github.io/webidl/#NoInterfaceObject">https://heycam.github.io/webidl/#NoInterfaceObject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-NoInterfaceObject">3.6.1. The AbstractWorker  abstract interface</a>
    <li><a href="#ref-for-NoInterfaceObject①">3.7. Concurrent hardware capabilities</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-securityerror">
   <a href="https://heycam.github.io/webidl/#securityerror">https://heycam.github.io/webidl/#securityerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-securityerror">3.6.3. Dedicated workers and the Worker interface</a>
    <li><a href="#ref-for-securityerror①">3.6.4. Shared workers and the SharedWorker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-syntaxerror">
   <a href="https://heycam.github.io/webidl/#syntaxerror">https://heycam.github.io/webidl/#syntaxerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-syntaxerror">3.6.3. Dedicated workers and the Worker interface</a>
    <li><a href="#ref-for-syntaxerror①">3.6.4. Shared workers and the SharedWorker interface</a>
    <li><a href="#ref-for-syntaxerror②">3.8. Importing scripts and libraries</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-urlmismatcherror">
   <a href="https://heycam.github.io/webidl/#urlmismatcherror">https://heycam.github.io/webidl/#urlmismatcherror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-urlmismatcherror">3.6.4. Shared workers and the SharedWorker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://heycam.github.io/webidl/#idl-USVString">https://heycam.github.io/webidl/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">3.1.1. The WorkerGlobalScope common interface</a>
    <li><a href="#ref-for-idl-USVString①">3.6.4. Shared workers and the SharedWorker interface</a>
    <li><a href="#ref-for-idl-USVString②">3.10. WorkerLocation interface</a> <a href="#ref-for-idl-USVString③">(2)</a> <a href="#ref-for-idl-USVString④">(3)</a> <a href="#ref-for-idl-USVString⑤">(4)</a> <a href="#ref-for-idl-USVString⑥">(5)</a> <a href="#ref-for-idl-USVString⑦">(6)</a> <a href="#ref-for-idl-USVString⑧">(7)</a> <a href="#ref-for-idl-USVString⑨">(8)</a> <a href="#ref-for-idl-USVString①⓪">(9)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-unsigned-long-long">
   <a href="https://heycam.github.io/webidl/#idl-unsigned-long-long">https://heycam.github.io/webidl/#idl-unsigned-long-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long-long">3.7. Concurrent hardware capabilities</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-xmlhttprequest-open-method-url-async-username-password-url">
   <a href="https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url">https://xhr.spec.whatwg.org/#dom-xmlhttprequest-open-method-url-async-username-password-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url">3.10. WorkerLocation interface</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url①">(2)</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url②">(3)</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url③">(4)</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url④">(5)</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url⑤">(6)</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url⑥">(7)</a> <a href="#ref-for-dom-xmlhttprequest-open-method-url-async-username-password-url⑦">(8)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-document" style="color:initial">Document</span>
     <li><span class="dfn-paneled" id="term-for-eventtarget" style="color:initial">EventTarget</span>
     <li><span class="dfn-paneled" id="term-for-dom-eventtarget-addeventlistener" style="color:initial">addEventListener(type, callback)</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-requestcredentials" style="color:initial">RequestCredentials</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-applicationcache" style="color:initial">ApplicationCache</span>
     <li><span class="dfn-paneled" id="term-for-errorevent" style="color:initial">ErrorEvent</span>
     <li><span class="dfn-paneled" id="term-for-eventhandler" style="color:initial">EventHandler</span>
     <li><span class="dfn-paneled" id="term-for-messageevent" style="color:initial">MessageEvent</span>
     <li><span class="dfn-paneled" id="term-for-messageport" style="color:initial">MessagePort</span>
     <li><span class="dfn-paneled" id="term-for-navigatorid" style="color:initial">NavigatorID</span>
     <li><span class="dfn-paneled" id="term-for-navigatorlanguage" style="color:initial">NavigatorLanguage</span>
     <li><span class="dfn-paneled" id="term-for-navigatoronline" style="color:initial">NavigatorOnLine</span>
     <li><span class="dfn-paneled" id="term-for-onerroreventhandler" style="color:initial">OnErrorEventHandler</span>
     <li><span class="dfn-paneled" id="term-for-event-workerglobalscope-connect" style="color:initial">connect</span>
     <li><span class="dfn-paneled" id="term-for-dom-workerglobalscope-importscripts" style="color:initial">importScripts(urls)</span>
     <li><span class="dfn-paneled" id="term-for-dom-meta-scheme" style="color:initial">scheme</span>
     <li><span class="dfn-paneled" id="term-for-dom-messageport-start" style="color:initial">start()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[IndexedDB-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-idbobjectstore-count-query-query" style="color:initial">query</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-ArrayBuffer" style="color:initial">ArrayBuffer</span>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString" style="color:initial">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-Exposed" style="color:initial">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-Global" style="color:initial">Global</span>
     <li><span class="dfn-paneled" id="term-for-networkerror" style="color:initial">NetworkError</span>
     <li><span class="dfn-paneled" id="term-for-NoInterfaceObject" style="color:initial">NoInterfaceObject</span>
     <li><span class="dfn-paneled" id="term-for-securityerror" style="color:initial">SecurityError</span>
     <li><span class="dfn-paneled" id="term-for-syntaxerror" style="color:initial">SyntaxError</span>
     <li><span class="dfn-paneled" id="term-for-urlmismatcherror" style="color:initial">URLMismatchError</span>
     <li><span class="dfn-paneled" id="term-for-idl-USVString" style="color:initial">USVString</span>
     <li><span class="dfn-paneled" id="term-for-idl-unsigned-long-long" style="color:initial">unsigned long long</span>
    </ul>
   <li>
    <a data-link-type="biblio">[XHR]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-xmlhttprequest-open-method-url-async-username-password-url" style="color:initial">url</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-indexeddb-2">[IndexedDB-2]
   <dd>Ali Alabbas; Joshua Bell. <a href="https://www.w3.org/TR/IndexedDB-2/">Indexed Database API 2.0</a>. 30 January 2018. REC. URL: <a href="https://www.w3.org/TR/IndexedDB-2/">https://www.w3.org/TR/IndexedDB-2/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-xhr">[XHR]
   <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/">XMLHttpRequest Standard</a>. Living Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-ecma-262">[ECMA-262]
   <dd><a href="https://tc39.github.io/ecma262/">ECMAScript Language Specification</a>. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
   <dt id="biblio-fileapi">[FILEAPI]
   <dd>Marijn Kruisselbrink; Arun Ranganathan. <a href="https://www.w3.org/TR/FileAPI/">File API</a>. 6 November 2018. WD. URL: <a href="https://www.w3.org/TR/FileAPI/">https://www.w3.org/TR/FileAPI/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑨"><c- g>Exposed</c-></a>=<c- n>Worker</c->]
<c- b>interface</c-> <a href="#workerglobalscope①"><code><c- g>WorkerGlobalScope</c-></code></a> : <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget③"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#workerglobalscope①" id="ref-for-workerglobalscope①①①⓪"><c- n>WorkerGlobalScope</c-></a> <a data-readonly data-type="WorkerGlobalScope" href="#dom-workerglobalscope-self"><code><c- g>self</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#workerlocation" id="ref-for-workerlocation④"><c- n>WorkerLocation</c-></a> <a data-readonly data-type="WorkerLocation" href="#dom-workerglobalscope-location"><code><c- g>location</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator⑥"><c- n>WorkerNavigator</c-></a> <a data-readonly data-type="WorkerNavigator" href="#dom-workerglobalscope-navigator"><code><c- g>navigator</c-></code></a>;
  <c- b>void</c-> <a href="#dom-workerglobalscope-importscripts"><code><c- g>importScripts</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①②"><c- b>USVString</c-></a>... <a href="#dom-workerglobalscope-importscripts-urls-urls"><code><c- g>urls</c-></code></a>);
  <c- b>void</c-> <a href="#dom-workerglobalscope-close"><code><c- g>close</c-></code></a>();

  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#onerroreventhandler" id="ref-for-onerroreventhandler①"><c- n>OnErrorEventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="OnErrorEventHandler" href="#handler-workerglobalscope-onerror" id="ref-for-handler-workerglobalscope-onerror①"><c- g>onerror</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①②"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onlanguagechange" id="ref-for-handler-workerglobalscope-onlanguagechange①"><c- g>onlanguagechange</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onoffline" id="ref-for-handler-workerglobalscope-onoffline①"><c- g>onoffline</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler②①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-ononline" id="ref-for-handler-workerglobalscope-ononline①"><c- g>ononline</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler③①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onrejectionhandled" id="ref-for-handler-workerglobalscope-onrejectionhandled①"><c- g>onrejectionhandled</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler④①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-workerglobalscope-onunhandledrejection" id="ref-for-handler-workerglobalscope-onunhandledrejection①"><c- g>onunhandledrejection</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global②"><c- g>Global</c-></a>=<a class="n" data-link-type="idl-name" href="#worker" id="ref-for-worker⑥①"><c- n>Worker</c-></a>,<a class="idl-code" data-link-type="extended-attribute"><c- g>DedicatedWorker</c-></a>,<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
/*sealed*/ <c- b>interface</c-> <a href="#dedicatedworkerglobalscope"><code><c- g>DedicatedWorkerGlobalScope</c-></code></a> : <a class="n" data-link-type="idl-name" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑧①"><c- n>WorkerGlobalScope</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-dedicatedworkerglobalscope-name"><code><c- g>name</c-></code></a>;

  <c- b>void</c-> <a href="#dom-dedicatedworkerglobalscope-postmessage"><code><c- g>postMessage</c-></code></a>(<c- b>any</c-> <a href="#dom-dedicatedworkerglobalscope-postmessage-message-transfer-message"><code><c- g>message</c-></code></a>, <c- b>optional</c-> <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name"><c- n>Transferable</c-></a>> <a href="#dom-dedicatedworkerglobalscope-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code></a>);

  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑤①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-dedicatedworkerglobalscope-onmessage" id="ref-for-handler-dedicatedworkerglobalscope-onmessage③①"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑥①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-dedicatedworkerglobalscope-onmessageerror" id="ref-for-handler-dedicatedworkerglobalscope-onmessageerror①"><c- g>onmessageerror</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global①①"><c- g>Global</c-></a>=<a class="n" data-link-type="idl-name" href="#worker" id="ref-for-worker①⓪①"><c- n>Worker</c-></a>,<a class="idl-code" data-link-type="extended-attribute"><c- g>SharedWorker</c-></a>,<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②①"><c- g>Exposed</c-></a>=<c- n>SharedWorker</c->]
/*sealed*/ <c- b>interface</c-> <a href="#sharedworkerglobalscope"><code><c- g>SharedWorkerGlobalScope</c-></code></a> : <a class="n" data-link-type="idl-name" href="#workerglobalscope①" id="ref-for-workerglobalscope①⑨①"><c- n>WorkerGlobalScope</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-sharedworkerglobalscope-name"><code><c- g>name</c-></code></a>;

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/offline.html#applicationcache" id="ref-for-applicationcache②"><c- n>ApplicationCache</c-></a> <a data-readonly data-type="ApplicationCache" href="#dom-sharedworkerglobalscope-applicationcache"><code><c- g>applicationCache</c-></code></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑦①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-sharedworkerglobalscope-onconnect" id="ref-for-handler-sharedworkerglobalscope-onconnect①①"><c- g>onconnect</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObject②"><c- g>NoInterfaceObject</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③①"><c- g>Exposed</c-></a>=<c- n>Window</c->,<a class="idl-code" data-link-type="extended-attribute"><c- g>Worker</c-></a>]
<c- b>interface</c-> <a href="#abstractworker"><code><c- g>AbstractWorker</c-></code></a> {
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑧①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-abstractworker-onerror" id="ref-for-handler-abstractworker-onerror①"><c- g>onerror</c-></a>;
};

[<a href="#dom-worker-worker"><code><c- g>Constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②①"><c- b>DOMString</c-></a> <a href="#dom-worker-worker-scripturl-scripturl"><code><c- g>scriptURL</c-></code></a>), <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④①"><c- g>Exposed</c-></a>=<c- n>Window</c->,<a class="idl-code" data-link-type="extended-attribute"><c- g>Worker</c-></a>]
<c- b>interface</c-> <a href="#worker"><code><c- g>Worker</c-></code></a> : <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①①"><c- n>EventTarget</c-></a> {
  <c- b>void</c-> <a href="#dom-worker-terminate"><code><c- g>terminate</c-></code></a>();

  <c- b>void</c-> <a href="#dom-worker-postmessage"><code><c- g>postMessage</c-></code></a>(<c- b>any</c-> <a href="#dom-worker-postmessage-message-transfer-message"><code><c- g>message</c-></code></a>, <c- b>optional</c-> <c- b>sequence</c->&lt;<a class="n" data-link-type="idl-name"><c- n>Transferable</c-></a>> <a href="#dom-worker-postmessage-message-transfer-transfer"><code><c- g>transfer</c-></code></a>);
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑨①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-worker-onmessage" id="ref-for-handler-worker-onmessage①"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①⓪①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#handler-worker-onmessageerror" id="ref-for-handler-worker-onmessageerror①"><c- g>onmessageerror</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-workeroptions"><code><c- g>WorkerOptions</c-></code></a> {
  <a class="n" data-link-type="idl-name" href="#enumdef-workertype" id="ref-for-enumdef-workertype①"><c- n>WorkerType</c-></a> <a data-default="&quot;classic&quot;" data-type="WorkerType " href="#dom-workeroptions-type"><code><c- g>type</c-></code></a> = "classic";
  <a class="n" data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#requestcredentials" id="ref-for-requestcredentials①"><c- n>RequestCredentials</c-></a> <a data-default="&quot;omit&quot;" data-type="RequestCredentials " href="#dom-workeroptions-credentials"><code><c- g>credentials</c-></code></a> = "omit"; // Only used if type is "module"
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString③①"><c- b>DOMString</c-></a> <a data-default="&quot;&quot;" data-type="DOMString " href="#dom-workeroptions-name"><code><c- g>name</c-></code></a> = "";
};

<c- b>enum</c-> <a href="#enumdef-workertype"><code><c- g>WorkerType</c-></code></a> { <a href="#dom-workertype-classic"><code><c- s>"classic"</c-></code></a>, <a href="#dom-workertype-module"><code><c- s>"module"</c-></code></a> };

<a class="n" data-link-type="idl-name" href="#worker" id="ref-for-worker①⑦①"><c- n>Worker</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="#abstractworker" id="ref-for-abstractworker②①"><c- n>AbstractWorker</c-></a> ;

[<a href="#dom-sharedworker-sharedworker"><code><c- g>Constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①①"><c- b>USVString</c-></a> <a href="#dom-sharedworker-sharedworker-scripturl-options-scripturl"><code><c- g>scriptURL</c-></code></a>, <c- b>optional</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString④①"><c- b>DOMString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#dictdef-workeroptions" id="ref-for-dictdef-workeroptions①"><c- n>WorkerOptions</c-></a>) <a href="#dom-sharedworker-sharedworker-scripturl-options-options"><code><c- g>options</c-></code></a>), <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤①"><c- g>Exposed</c-></a>=<c- n>Window</c->,<a class="idl-code" data-link-type="extended-attribute"><c- g>Worker</c-></a>]
<c- b>interface</c-> <a href="#sharedworker"><code><c- g>SharedWorker</c-></code></a> : <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget②①"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①⓪①"><c- n>MessagePort</c-></a> <a data-readonly data-type="MessagePort" href="#dom-sharedworker-port"><code><c- g>port</c-></code></a>;
};
<a class="n" data-link-type="idl-name" href="#sharedworker" id="ref-for-sharedworker⑤①"><c- n>SharedWorker</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="#abstractworker" id="ref-for-abstractworker③①"><c- n>AbstractWorker</c-></a> ;

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObject①①"><c- g>NoInterfaceObject</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#navigatorconcurrenthardware"><code><c- g>NavigatorConcurrentHardware</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-readonly data-type="unsigned long long" href="#dom-navigatorconcurrenthardware-hardwareconcurrency"><code><c- g>hardwareConcurrency</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦①"><c- g>Exposed</c-></a>=<c- n>Worker</c->]
<c- b>interface</c-> <a href="#workernavigator"><code><c- g>WorkerNavigator</c-></code></a> {};
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator②①"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/system-state.html#navigatorid" id="ref-for-navigatorid①"><c- n>NavigatorID</c-></a>;
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator③①"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/system-state.html#navigatorlanguage" id="ref-for-navigatorlanguage①"><c- n>NavigatorLanguage</c-></a>;
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator④①"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/offline.html#navigatoronline" id="ref-for-navigatoronline①"><c- n>NavigatorOnLine</c-></a>;
<a class="n" data-link-type="idl-name" href="#workernavigator" id="ref-for-workernavigator⑤①"><c- n>WorkerNavigator</c-></a> <c- b>implements</c-> <a class="n" data-link-type="idl-name" href="#navigatorconcurrenthardware" id="ref-for-navigatorconcurrenthardware②"><c- n>NavigatorConcurrentHardware</c-></a>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧①"><c- g>Exposed</c-></a>=<c- n>Worker</c->]
<c- b>interface</c-> <a href="#workerlocation"><code><c- g>WorkerLocation</c-></code></a> {
  <a href="#WorkerLocation-stringification-behavior"><c- b>stringifier</c-></a> <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString②①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-href"><code><c- g>href</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString③①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-origin"><code><c- g>origin</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString④①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-protocol"><code><c- g>protocol</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑤①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-host"><code><c- g>host</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑥①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-hostname"><code><c- g>hostname</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑦①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-port"><code><c- g>port</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑧①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-pathname"><code><c- g>pathname</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑨①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-search"><code><c- g>search</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①⓪①"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-workerlocation-hash"><code><c- g>hash</c-></code></a>;
};

</pre>
  <aside class="dfn-panel" data-for="workerglobalscope①">
   <b><a href="#workerglobalscope①">#workerglobalscope①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workerglobalscope①">3.1.1. The WorkerGlobalScope common interface</a> <a href="#ref-for-workerglobalscope①①">(2)</a> <a href="#ref-for-workerglobalscope①②">(3)</a> <a href="#ref-for-workerglobalscope①③">(4)</a> <a href="#ref-for-workerglobalscope①④">(5)</a> <a href="#ref-for-workerglobalscope①⑤">(6)</a> <a href="#ref-for-workerglobalscope①⑥">(7)</a> <a href="#ref-for-workerglobalscope①⑦">(8)</a>
    <li><a href="#ref-for-workerglobalscope①⑧">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-workerglobalscope①⑨">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-workerglobalscope①①⓪">3.2. The event loop</a> <a href="#ref-for-workerglobalscope①①①">(2)</a>
    <li><a href="#ref-for-workerglobalscope①①②">3.3. The worker’s lifetime</a> <a href="#ref-for-workerglobalscope①①③">(2)</a> <a href="#ref-for-workerglobalscope①①④">(3)</a> <a href="#ref-for-workerglobalscope①①⑤">(4)</a> <a href="#ref-for-workerglobalscope①①⑥">(5)</a> <a href="#ref-for-workerglobalscope①①⑦">(6)</a>
    <li><a href="#ref-for-workerglobalscope①①⑧">3.4. Processing model</a> <a href="#ref-for-workerglobalscope①①⑨">(2)</a> <a href="#ref-for-workerglobalscope①②⓪">(3)</a> <a href="#ref-for-workerglobalscope①②①">(4)</a> <a href="#ref-for-workerglobalscope①②②">(5)</a> <a href="#ref-for-workerglobalscope①②③">(6)</a>
    <li><a href="#ref-for-workerglobalscope①②④">3.5. Runtime script errors</a>
    <li><a href="#ref-for-workerglobalscope①②⑤">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-workerglobalscope①②⑥">(2)</a>
    <li><a href="#ref-for-workerglobalscope①②⑦">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-workerglobalscope①②⑧">(2)</a> <a href="#ref-for-workerglobalscope①②⑨">(3)</a> <a href="#ref-for-workerglobalscope①③⓪">(4)</a>
    <li><a href="#ref-for-workerglobalscope①③①">3.8. Importing scripts and libraries</a>
    <li><a href="#ref-for-workerglobalscope①③②">3.9. The WorkerNavigator object</a>
    <li><a href="#ref-for-workerglobalscope①③③">3.10. WorkerLocation interface</a> <a href="#ref-for-workerglobalscope①③④">(2)</a> <a href="#ref-for-workerglobalscope①③⑤">(3)</a> <a href="#ref-for-workerglobalscope①③⑥">(4)</a> <a href="#ref-for-workerglobalscope①③⑦">(5)</a> <a href="#ref-for-workerglobalscope①③⑧">(6)</a> <a href="#ref-for-workerglobalscope①③⑨">(7)</a> <a href="#ref-for-workerglobalscope①④⓪">(8)</a> <a href="#ref-for-workerglobalscope①④①">(9)</a> <a href="#ref-for-workerglobalscope①④②">(10)</a> <a href="#ref-for-workerglobalscope①④③">(11)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerglobalscope-self">
   <b><a href="#dom-workerglobalscope-self">#dom-workerglobalscope-self</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerglobalscope-self">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerglobalscope-location">
   <b><a href="#dom-workerglobalscope-location">#dom-workerglobalscope-location</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerglobalscope-location">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerglobalscope-navigator">
   <b><a href="#dom-workerglobalscope-navigator">#dom-workerglobalscope-navigator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerglobalscope-navigator">3.9. The WorkerNavigator object</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerglobalscope-close">
   <b><a href="#dom-workerglobalscope-close">#dom-workerglobalscope-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerglobalscope-close">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-workerglobalscope-onerror">
   <b><a href="#handler-workerglobalscope-onerror">#handler-workerglobalscope-onerror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-workerglobalscope-onerror">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-workerglobalscope-onlanguagechange">
   <b><a href="#handler-workerglobalscope-onlanguagechange">#handler-workerglobalscope-onlanguagechange</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-workerglobalscope-onlanguagechange">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-workerglobalscope-onoffline">
   <b><a href="#handler-workerglobalscope-onoffline">#handler-workerglobalscope-onoffline</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-workerglobalscope-onoffline">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-workerglobalscope-ononline">
   <b><a href="#handler-workerglobalscope-ononline">#handler-workerglobalscope-ononline</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-workerglobalscope-ononline">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-workerglobalscope-onrejectionhandled">
   <b><a href="#handler-workerglobalscope-onrejectionhandled">#handler-workerglobalscope-onrejectionhandled</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-workerglobalscope-onrejectionhandled">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-workerglobalscope-onunhandledrejection">
   <b><a href="#handler-workerglobalscope-onunhandledrejection">#handler-workerglobalscope-onunhandledrejection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-workerglobalscope-onunhandledrejection">3.1.1. The WorkerGlobalScope common interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dedicatedworkerglobalscope">
   <b><a href="#dedicatedworkerglobalscope">#dedicatedworkerglobalscope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dedicatedworkerglobalscope">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a> <a href="#ref-for-dedicatedworkerglobalscope①">(2)</a> <a href="#ref-for-dedicatedworkerglobalscope②">(3)</a> <a href="#ref-for-dedicatedworkerglobalscope③">(4)</a> <a href="#ref-for-dedicatedworkerglobalscope④">(5)</a> <a href="#ref-for-dedicatedworkerglobalscope⑤">(6)</a>
    <li><a href="#ref-for-dedicatedworkerglobalscope⑥">3.4. Processing model</a> <a href="#ref-for-dedicatedworkerglobalscope⑦">(2)</a> <a href="#ref-for-dedicatedworkerglobalscope⑧">(3)</a> <a href="#ref-for-dedicatedworkerglobalscope⑨">(4)</a>
    <li><a href="#ref-for-dedicatedworkerglobalscope①⓪">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-dedicatedworkerglobalscope-name">
   <b><a href="#dom-dedicatedworkerglobalscope-name">#dom-dedicatedworkerglobalscope-name</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-name">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a> <a href="#ref-for-dom-dedicatedworkerglobalscope-name①">(2)</a> <a href="#ref-for-dom-dedicatedworkerglobalscope-name②">(3)</a>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-name③">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a> <a href="#ref-for-dom-dedicatedworkerglobalscope-name④">(2)</a>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-name⑤">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-dom-dedicatedworkerglobalscope-name⑥">(2)</a>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-name⑦">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-dom-dedicatedworkerglobalscope-name⑧">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-dedicatedworkerglobalscope-postmessage">
   <b><a href="#dom-dedicatedworkerglobalscope-postmessage">#dom-dedicatedworkerglobalscope-postmessage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-postmessage">1.2.1. A background number-crunching worker</a>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-postmessage①">1.3.2. Communicating with a dedicated worker</a>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-postmessage②">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-dom-dedicatedworkerglobalscope-postmessage③">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-dom-dedicatedworkerglobalscope-postmessage④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-dedicatedworkerglobalscope-onmessage">
   <b><a href="#handler-dedicatedworkerglobalscope-onmessage">#handler-dedicatedworkerglobalscope-onmessage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-dedicatedworkerglobalscope-onmessage">1.2.1. A background number-crunching worker</a>
    <li><a href="#ref-for-handler-dedicatedworkerglobalscope-onmessage①">1.3.2. Communicating with a dedicated worker</a> <a href="#ref-for-handler-dedicatedworkerglobalscope-onmessage②">(2)</a>
    <li><a href="#ref-for-handler-dedicatedworkerglobalscope-onmessage③">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-dedicatedworkerglobalscope-onmessageerror">
   <b><a href="#handler-dedicatedworkerglobalscope-onmessageerror">#handler-dedicatedworkerglobalscope-onmessageerror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-dedicatedworkerglobalscope-onmessageerror">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="sharedworkerglobalscope">
   <b><a href="#sharedworkerglobalscope">#sharedworkerglobalscope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedworkerglobalscope">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a> <a href="#ref-for-sharedworkerglobalscope①">(2)</a> <a href="#ref-for-sharedworkerglobalscope②">(3)</a> <a href="#ref-for-sharedworkerglobalscope③">(4)</a> <a href="#ref-for-sharedworkerglobalscope④">(5)</a> <a href="#ref-for-sharedworkerglobalscope⑤">(6)</a>
    <li><a href="#ref-for-sharedworkerglobalscope⑥">3.3. The worker’s lifetime</a> <a href="#ref-for-sharedworkerglobalscope⑦">(2)</a>
    <li><a href="#ref-for-sharedworkerglobalscope⑧">3.4. Processing model</a> <a href="#ref-for-sharedworkerglobalscope⑨">(2)</a>
    <li><a href="#ref-for-sharedworkerglobalscope①⓪">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-sharedworkerglobalscope①①">(2)</a> <a href="#ref-for-sharedworkerglobalscope①②">(3)</a> <a href="#ref-for-sharedworkerglobalscope①③">(4)</a> <a href="#ref-for-sharedworkerglobalscope①④">(5)</a> <a href="#ref-for-sharedworkerglobalscope①⑤">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-sharedworkerglobalscope-onconnect">
   <b><a href="#handler-sharedworkerglobalscope-onconnect">#handler-sharedworkerglobalscope-onconnect</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-sharedworkerglobalscope-onconnect">1.2.4. Shared state using a shared worker</a>
    <li><a href="#ref-for-handler-sharedworkerglobalscope-onconnect①">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstractworker">
   <b><a href="#abstractworker">#abstractworker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstractworker">3.6.1. The AbstractWorker  abstract interface</a> <a href="#ref-for-abstractworker①">(2)</a>
    <li><a href="#ref-for-abstractworker②">3.6.3. Dedicated workers and the Worker interface</a>
    <li><a href="#ref-for-abstractworker③">3.6.4. Shared workers and the SharedWorker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-abstractworker-onerror">
   <b><a href="#handler-abstractworker-onerror">#handler-abstractworker-onerror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-abstractworker-onerror">3.6.1. The AbstractWorker  abstract interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-worker-worker">
   <b><a href="#dom-worker-worker">#dom-worker-worker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-worker-worker">1.3.1. Creating a dedicated worker</a>
    <li><a href="#ref-for-dom-worker-worker①">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-worker-worker-scripturl-scripturl">
   <b><a href="#dom-worker-worker-scripturl-scripturl">#dom-worker-worker-scripturl-scripturl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-worker-worker-scripturl-scripturl">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl①">(2)</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl②">(3)</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl③">(4)</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl④">(5)</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl⑤">(6)</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl⑥">(7)</a> <a href="#ref-for-dom-worker-worker-scripturl-scripturl⑦">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="worker">
   <b><a href="#worker">#worker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-worker">1.1. Scope</a>
    <li><a href="#ref-for-worker①">1.2.1. A background number-crunching worker</a> <a href="#ref-for-worker②">(2)</a>
    <li><a href="#ref-for-worker③">1.2.2. Worker used for background I/O</a>
    <li><a href="#ref-for-worker④">1.3.2. Communicating with a dedicated worker</a> <a href="#ref-for-worker⑤">(2)</a>
    <li><a href="#ref-for-worker⑥">3.1.2. Dedicated workers and the DedicatedWorkerGlobalScope interface</a> <a href="#ref-for-worker⑦">(2)</a> <a href="#ref-for-worker⑧">(3)</a> <a href="#ref-for-worker⑨">(4)</a>
    <li><a href="#ref-for-worker①⓪">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a>
    <li><a href="#ref-for-worker①①">3.4. Processing model</a>
    <li><a href="#ref-for-worker①②">3.5. Runtime script errors</a> <a href="#ref-for-worker①③">(2)</a> <a href="#ref-for-worker①④">(3)</a> <a href="#ref-for-worker①⑤">(4)</a>
    <li><a href="#ref-for-worker①⑥">3.6.3. Dedicated workers and the Worker interface</a> <a href="#ref-for-worker①⑦">(2)</a> <a href="#ref-for-worker①⑧">(3)</a> <a href="#ref-for-worker①⑨">(4)</a> <a href="#ref-for-worker②⓪">(5)</a> <a href="#ref-for-worker②①">(6)</a> <a href="#ref-for-worker②②">(7)</a> <a href="#ref-for-worker②③">(8)</a> <a href="#ref-for-worker②④">(9)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-worker-terminate">
   <b><a href="#dom-worker-terminate">#dom-worker-terminate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-worker-terminate">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-workeroptions">
   <b><a href="#dictdef-workeroptions">#dictdef-workeroptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-workeroptions">3.6.4. Shared workers and the SharedWorker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-workertype">
   <b><a href="#enumdef-workertype">#enumdef-workertype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-workertype">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-worker-onmessage">
   <b><a href="#handler-worker-onmessage">#handler-worker-onmessage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-worker-onmessage">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler-worker-onmessageerror">
   <b><a href="#handler-worker-onmessageerror">#handler-worker-onmessageerror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-worker-onmessageerror">3.6.3. Dedicated workers and the Worker interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-sharedworker-sharedworker">
   <b><a href="#dom-sharedworker-sharedworker">#dom-sharedworker-sharedworker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-sharedworker-sharedworker">1.3.3. Shared workers</a> <a href="#ref-for-dom-sharedworker-sharedworker①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="sharedworker">
   <b><a href="#sharedworker">#sharedworker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedworker">3.1.3. Shared workers and the SharedWorkerGlobalScope interface</a> <a href="#ref-for-sharedworker①">(2)</a> <a href="#ref-for-sharedworker②">(3)</a>
    <li><a href="#ref-for-sharedworker③">3.4. Processing model</a>
    <li><a href="#ref-for-sharedworker④">3.6.4. Shared workers and the SharedWorker interface</a> <a href="#ref-for-sharedworker⑤">(2)</a> <a href="#ref-for-sharedworker⑥">(3)</a> <a href="#ref-for-sharedworker⑦">(4)</a> <a href="#ref-for-sharedworker⑧">(5)</a> <a href="#ref-for-sharedworker⑨">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-sharedworker-port">
   <b><a href="#dom-sharedworker-port">#dom-sharedworker-port</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-sharedworker-port">1.3.3. Shared workers</a>
    <li><a href="#ref-for-dom-sharedworker-port①">3.6.4. Shared workers and the SharedWorker interface</a>
    <li><a href="#ref-for-dom-sharedworker-port②">3.10. WorkerLocation interface</a> <a href="#ref-for-dom-sharedworker-port③">(2)</a> <a href="#ref-for-dom-sharedworker-port④">(3)</a> <a href="#ref-for-dom-sharedworker-port⑤">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigatorconcurrenthardware">
   <b><a href="#navigatorconcurrenthardware">#navigatorconcurrenthardware</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigatorconcurrenthardware">3.9. The WorkerNavigator object</a>
    <li><a href="#ref-for-navigatorconcurrenthardware①">3.12. Privacy Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="workernavigator">
   <b><a href="#workernavigator">#workernavigator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workernavigator">3.1.1. The WorkerGlobalScope common interface</a>
    <li><a href="#ref-for-workernavigator①">3.9. The WorkerNavigator object</a> <a href="#ref-for-workernavigator②">(2)</a> <a href="#ref-for-workernavigator③">(3)</a> <a href="#ref-for-workernavigator④">(4)</a> <a href="#ref-for-workernavigator⑤">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="workerlocation">
   <b><a href="#workerlocation">#workerlocation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-workerlocation">3.1.1. The WorkerGlobalScope common interface</a> <a href="#ref-for-workerlocation①">(2)</a>
    <li><a href="#ref-for-workerlocation②">3.10. WorkerLocation interface</a> <a href="#ref-for-workerlocation③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerlocation-origin">
   <b><a href="#dom-workerlocation-origin">#dom-workerlocation-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerlocation-origin">1.3.3. Shared workers</a>
    <li><a href="#ref-for-dom-workerlocation-origin①">3.10. WorkerLocation interface</a> <a href="#ref-for-dom-workerlocation-origin②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerlocation-protocol">
   <b><a href="#dom-workerlocation-protocol">#dom-workerlocation-protocol</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerlocation-protocol">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerlocation-host">
   <b><a href="#dom-workerlocation-host">#dom-workerlocation-host</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerlocation-host">3.10. WorkerLocation interface</a> <a href="#ref-for-dom-workerlocation-host①">(2)</a> <a href="#ref-for-dom-workerlocation-host②">(3)</a> <a href="#ref-for-dom-workerlocation-host③">(4)</a> <a href="#ref-for-dom-workerlocation-host④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerlocation-hostname">
   <b><a href="#dom-workerlocation-hostname">#dom-workerlocation-hostname</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerlocation-hostname">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerlocation-pathname">
   <b><a href="#dom-workerlocation-pathname">#dom-workerlocation-pathname</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerlocation-pathname">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-workerlocation-search">
   <b><a href="#dom-workerlocation-search">#dom-workerlocation-search</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-workerlocation-search">3.10. WorkerLocation interface</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>